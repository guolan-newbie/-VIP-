/*!
 * FusionCharts JavaScript Library
 * Copyright FusionCharts Technologies LLP
 * @license License Information at <http://www.fusioncharts.com/license>
 *
 * @author FusionCharts
 * @version 3.2.1-release
 *
 * Third-party attributions:
 * SWFObject v2.2 <http://code.google.com/p/swfobject/>
 * JSON v2 <http://www.JSON.org/js.html>
 * Firebug Lite 1.3.0 <http://getfirebug.com/firebuglite>
 * jQuery 1.4.2 <http://jquery.com/>
 * change log: 2011-09-14 add setDataUrlParams method, fixbug: 多次提交ajax bug
 */
(function(){if(typeof window.FusionCharts!=='undefined'){return}var global={},modules={},argsT=['swfUrl','id','width','height','debugMode','registerWithJS','bgColor','scaleMode','lang','detectFlashVersion','autoInstallRedirect'];global.dataUrlParams=[];global.extend=function(obj1,obj2){var deep=typeof arguments[arguments.length-1]==='boolean'?arguments[arguments.length-1]:false;var src=obj2,snk=obj1;if(typeof obj2==='boolean'||arguments.length===1){snk=global.core;src=obj1}if(deep===true){snk=snk.prototype}for(var item in src){snk[item]=src[item]}return snk};global.uniqueId=function(){return'chartobject-'+(global.uniqueId.lastId+=1)};global.uniqueId.lastId=0;global.policies={options:{product:['product','v3'],insertMode:['insertMode','replace'],safeMode:['safeMode',true],overlayButton:['overlayButton',undefined]},attributes:{lang:['lang','EN'],'class':['className','FusionCharts']},width:['width','400'],height:['height','300'],src:['swfUrl',''],__state:{}};global.parsePolicies=function(obj,policies,options){var prop,policy,value;for(policy in policies){if(global.policies[policy]instanceof Array){value=options[policies[policy][0]];obj[policy]=value===undefined?policies[policy][1]:value;continue}if(typeof obj[policy]!=='object'){obj[policy]={}}for(prop in policies[policy]){value=options[policies[policy][prop][0]];obj[policy][prop]=value===undefined?policies[policy][prop][1]:value}}};global.core=function(command){if(!(this instanceof global.core)){if(arguments.length===1&&command instanceof Array&&command[0]==='private'){if(modules[command[1]]===true){return undefined}modules[command[1]]=true;return global}if(arguments.length===1&&typeof command==='string'){return global.core.items[command]}global.raiseError(this,'25081840','run','',new SyntaxError("Use the \"new\" keyword while creating a new FusionCharts object"))}var options={},prop;if(arguments.length===1&&typeof arguments[0]==='object'){options=arguments[0]}else{for(prop in argsT){options[argsT[prop]]=arguments[prop]}}if(typeof arguments[arguments.length-1]==='object'){delete options[arguments.length-1];global.extend(options,arguments[arguments.length-1])}this.id=typeof options.id==='undefined'?this.id=global.uniqueId():options.id;this.args=options;if(global.core.items[this.id]instanceof global.core){this.id=global.uniqueId();global.raiseWarning(this,'06091847','param','','A FusionChart oject with the specified id \"'+this.id+'\" already exists. Renaming it to '+this.id)}global.parsePolicies(this,global.policies,options);this.resizeTo(options.width,options.height,true);global.raiseEvent('BeforeInitialize',options,this);global.core.items[this.id]=this;global.raiseEvent('Initialized',options,this);return this};global.core.prototype={};global.core.prototype.constructor=global.core;global.extend({id:'FusionCharts',version:[3,2,1,'release',1750],items:{},options:{},getObjectReference:function(id){return global.core.items[id].ref}},false);window.FusionCharts=global.core}());(function(){var global=FusionCharts(['private','EventManager']);if(global===undefined){return}window.FusionChartsEvents={BeforeInitialize:'beforeinitialize',Initialized:'initialized',Loaded:'loaded',Rendered:'rendered',DataLoadRequested:'dataloadrequested',DataLoadRequestCancelled:'dataloadrequestcancelled',DataLoadRequestCompleted:'dataloadrequestcompleted',BeforeDataUpdate:'beforedataupdate',DataUpdateCancelled:'dataupdatecancelled',DataUpdated:'dataupdated',DataLoadCancelled:'dataloadcancelled',DataLoaded:'dataloaded',DataLoadError:'dataloaderror',NoDataToDisplay:'nodatatodisplay',DataXMLInvalid:'dataxmlinvalid',InvalidDataError:'invaliddataerror',DrawComplete:'drawcomplete',Resized:'resized',BeforeDispose:'beforedispose',Disposed:'disposed'};var managedFnCall=function(item,scope,event,args){try{item[0].call(scope,event,args||{})}catch(e){setTimeout(function(){throw e;},0)}};var slotLoader=function(slot,event,args){if(!(slot instanceof Array)){return}var i=0,scope;for(;i<slot.length;i+=1){if(slot[i][1]===event.sender||slot[i][1]===undefined){scope=slot[i][1]===event.sender?event.sender:global.core;managedFnCall(slot[i],scope,event,args)}if(event.cancel===true){break}}};var EventTarget={listeners:{},lastEventId:0,addListener:function(type,listener,bind){if(type instanceof Array){for(var i=0;i<type.length;i+=1){EventTarget.addListener(type[i],listener,bind)}return}if(typeof type!=='string'){global.raiseError(this,'03091549','param','::EventTarget.addListener',new Error('Unspecified Event Type'));return}if(typeof listener!=='function'){global.raiseError(this,'03091550','param','::EventTarget.addListener',new Error('Invalid Event Listener'));return}type=type.toLowerCase();if(!(EventTarget.listeners[type]instanceof Array)){EventTarget.listeners[type]=[]}EventTarget.listeners[type].push([listener,bind])},removeListener:function(type,listener,bind){var i;if(type instanceof Array){for(i=0;i<type.length;i+=1){EventTarget.removeListener(type[i],listener,bind)}return}if(typeof type!=='string'){global.raiseError(this,'03091559','param','::EventTarget.removeListener',new Error('Unspecified Event Type'));return}if(typeof listener!=='function'){global.raiseError(this,'03091560','param','::EventTarget.removeListener',new Error('Invalid Event Listener'));return}type=type.toLowerCase();var slot=EventTarget.listeners[type];if(!(slot instanceof Array)){return}for(i=0;i<slot.length;i+=1){if(slot[i][0]===listener&&slot[i][1]===bind){slot.splice(i,1);i-=1}}},triggerEvent:function(type,sender,args){if(typeof type!=='string'){global.raiseError(this,'03091602','param','::EventTarget.dispatchEvent',new Error('Invalid Event Type'));return undefined}type=type.toLowerCase();var event={eventType:type,eventId:(EventTarget.lastEventId+=1),sender:(typeof sender==='string'?global.core.items[sender]:sender),stopPropagation:function(){return(this.cancel=true)===false}};slotLoader(EventTarget.listeners[type],event,args);slotLoader(EventTarget.listeners['*'],event,args);return true}};global.raiseEvent=function(type,args,obj){return EventTarget.triggerEvent(type,(obj===undefined?global.core:obj),args)};global.addEventListener=function(type,listener){return EventTarget.addListener(type,listener)};global.removeEventListener=function(type,listener){return EventTarget.removeListener(type,listener)};global.extend({addEventListener:global.addEventListener,removeEventListener:global.removeEventListener},false);global.extend({addEventListener:function(type,listener){return EventTarget.addListener(type,listener,this)},removeEventListener:function(type,listener){return EventTarget.removeListener(type,listener,this)}},true);global.addEventListener('BeforeDispose',function(e){var type,i;for(type in EventTarget.listeners){for(i=0;i<EventTarget.listeners[type].length;i+=1){if(EventTarget.listeners[type][i][1]===e.sender){EventTarget.listeners[type].splice(i,1)}}}})}());(function(){var global=FusionCharts(['private','ErrorHandler']);if(global===undefined){return}var DEFAULT_OUTPUT_HELPER='text';var errorNatures={type:'TypeException',range:'ValueRangeException',impl:'NotImplementedException',param:'ParameterException',run:'RuntimeException',comp:'DesignTimeError','undefined':'UnspecifiedException'};var raiseEWEvent=function(sender,id,nature,source,err,level){var message='#'+id+' '+sender.id+source+' '+level+' >> ';if(err instanceof Error){err.name=errorNatures[nature];err.module='FusionCharts'+source;err.level=level;err.message=message+err.message;message=err.message;window.setTimeout(function(){throw err;},0)}else{message=message+err}var args={id:id,nature:errorNatures[nature],source:'FusionCharts'+source,message:message};global.raiseEvent(level,args,sender);if(typeof window['FC_'+level]==='function'){window['FC_'+level](args)}};global.raiseError=function(sender,id,nature,source,message){raiseEWEvent(sender,id,nature,source,message,'Error')};global.raiseWarning=function(sender,id,nature,source,message){raiseEWEvent(sender,id,nature,source,message,'Warning')};var logger={outputHelpers:{'text':function(e,a){var sender=(e.sender.id||e.sender).toString();logger.outputTo('#'+e.eventId+' ['+sender+'] fired "'+e.eventType+'" event. '+(e.eventType==='error'||e.eventType==='warning'?a.message:''))},'event':function(e,a){this.outputTo(e,a)},'verbose':function(e,a){logger.outputTo(e.eventId,e.sender.id,e.eventType,a)}},outputHandler:function(e,a){if(typeof logger.outputTo!=='function'){global.core.debugMode.outputFailed=true;return}global.core.debugMode.outputFailed=false;logger.currentOutputHelper(e,a)},currentOutputHelper:undefined,outputTo:undefined,enabled:false};logger.currentOutputHelper=logger.outputHelpers[DEFAULT_OUTPUT_HELPER];global.extend({debugMode:{outputFormat:function(format){if(format&&typeof format.toLowerCase==='function'&&typeof logger.outputHelpers[format=format.toLowerCase()]==='function'){logger.currentOutputHelper=logger.outputHelpers[format];return true}return false},outputTo:function(fn){if(typeof fn==='function'){logger.outputTo=fn}else if(fn===null){global.core.debugMode.enabled(false);delete logger.outputTo}},enabled:function(state,outputTo,format){if(typeof state==='function'){if(typeof outputTo==='string'&&arguments.length===2){format=outputTo}outputTo=state;state=true}if(typeof state==='boolean'&&state!==logger.enabled){global.core[(logger.enabled=state)?'addEventListener':'removeEventListener']('*',logger.outputHandler)}if(typeof outputTo==='function'){logger.outputTo=outputTo}global.core.debugMode.outputFormat(format);return logger.enabled},_enableFirebugLite:function(url){if(window.console&&window.console.firebug){global.core.debugMode.enabled(console.log,'verbose');return}var script=document.createElement('script');script.type='text/javascript';script.src=typeof url==='string'?url:global.core.options.scriptBaseUri+'firebug-lite.js';script['\v'==='v'?'text':'innerHTML']='{ startOpened: true }';script.onload=function(){global.core.debugMode.enabled(console.log,'verbose')};script.onreadystatechange=function(){if(this.readyState==='complete'||this.readyState==='loaded'){global.core.debugMode.enabled(console.log,'verbose')}};document.getElementsByTagName('head')[0].appendChild(script)}}},false)}());(function(){var global=FusionCharts(['private','RendererManager']);if(global===undefined){return}global.policies.options.containerElementId=['renderAt',undefined];global.policies.options.renderer=['renderer',undefined];var notDefined=function(){global.raiseError(this,'25081845','run','::RendererManager',new Error('No active renderer'));return};var renderers={'undefined':{render:notDefined,update:notDefined,resize:notDefined,config:notDefined,policies:{}}},store={};global.renderer={register:function(name,obj){if(!name||typeof name.toString!=='function'){throw"#03091436 ~renderer.register() Invalid value for renderer name.";}name=name.toString().toLowerCase();if(renderers[name]!==undefined){global.raiseError(global.core,'03091438','param','::RendererManager>register','Duplicate renderer name specified in "name"');return false}renderers[name]=obj;return true},setDefault:function(name){if(!name||typeof name.toString!=='function'){global.raiseError(global.core,'25081731','param','::RendererManager>setDefault','Invalid renderer name specified in "name"');return false}if(renderers[name=name.toString().toLowerCase()]===undefined){global.raiseError(global.core,'25081733','range','::RendererManager>setDefault','The specified renderer does not exist.');return false}global.policies.options.renderer=['renderer',name];return true},getRenderer:function(name){return renderers[name]},getRendererPolicy:function(name){var policies=renderers[name].policies;return typeof policies==='object'?policies:{}},currentRendererName:function(){return global.policies.options.renderer[1]},update:function(obj){store[obj.id].update.apply(obj,Array.prototype.slice.call(arguments,1))},render:function(obj){store[obj.id].render.apply(obj,Array.prototype.slice.call(arguments,1))},resize:function(obj){store[obj.id].resize.apply(obj,Array.prototype.slice.call(arguments,1))},config:function(obj){store[obj.id].config.apply(obj,Array.prototype.slice.call(arguments,1))}};var eiCall=function(method){return function(){if(this.ref===undefined||this.ref===null||typeof this.ref[method]!=='function'){global.raiseError(this,'25081617','run','~'+method+'()','ExternalInterface call failed. Check whether chart has been rendered.');return undefined}return this.ref[method].apply(this.ref,arguments)}};global.addEventListener('BeforeInitialize',function(event){var obj=event.sender;if(typeof obj.options.renderer==='string'&&renderers[obj.options.renderer.toLowerCase()]===undefined){obj.options.renderer=global.policies.options.renderer[1]}obj.options.renderer=obj.options.renderer.toLowerCase();store[obj.id]=renderers[obj.options.renderer];if(store[obj.id].initialized!==true&&typeof store[obj.id].init==='function'){store[obj.id].init();store[obj.id].initialized=true}global.parsePolicies(obj,store[obj.id].policies||{},obj.args);for(var prop in store[obj.id].prototype){obj[prop]=store[obj.id].prototype[prop]}});global.addEventListener('Loaded',function(e){var obj=e.sender,chartObj=e.sender.ref;if(obj instanceof global.core){delete obj.__state.rendering}if(chartObj===undefined||chartObj===null||typeof chartObj.getExternalInterfaceMethods!=='function'){return}var eiItems=chartObj.getExternalInterfaceMethods().split(','),i;for(i=0;i<eiItems.length;i+=1){if(obj[eiItems[i]]===undefined){obj[eiItems[i]]=eiCall(eiItems[i])}}});var isDuplicateId=function(lookupId,container){var lookupElement=document.getElementById(lookupId),containerId=container.getAttribute('id');if(lookupElement===null){return false}if(lookupId===containerId){return true}var children=container.getElementsByTagName('*');for(var i=0;i<children.length;i+=1){if(children[i]===lookupElement){return false}}return true};var updatePostRender=function(status){if(status.success===false){global.raiseError(global.core.items[status.id],'25081850','run','::RendererManager',new Error('There was an error rendering the chart. '+'Enable FusionCharts JS debugMode for more information.'))}global.core.items[status.id].ref=status.ref;if(status.ref){status.ref.FusionCharts=global.core.items[status.id]}global.raiseEvent('internal.DOMElementCreated',status,global.core.items[status.id])};global.extend({render:function(containerElement){if(window[this.id]!==undefined){global.raiseError(this,'25081843','comp','.render',new Error('#25081843:IECompatibility() Chart '+'Id is same as a JavaScript variable name. Variable naming '+'error. Please use unique name for chart JS variable, '+'chart-id and container id.'))}var alt=document.createElement('span');if(containerElement===undefined){containerElement=this.options.containerElementId}if(typeof containerElement==='string'){containerElement=document.getElementById(containerElement)}if(containerElement===undefined||containerElement===null){global.raiseError(this,'03091456','run','.render()',new Error("Unable to find the container DOM element."));return this}if(isDuplicateId(this.id,containerElement)){global.raiseError(this,'05102109','run','.render()',new Error("A duplicate object already exists with the specific Id: "+this.id));return this}alt.setAttribute('id',this.id);if(this.options.insertMode==='replace'){while(containerElement.hasChildNodes()){containerElement.removeChild(containerElement.firstChild)}}containerElement.appendChild(alt);this.options.containerElement=containerElement;this.options.containerElementId=containerElement.id;this.__state.rendering=true;global.renderer.render(this,containerElement,updatePostRender);return this},configure:function(key,value){global.renderer.config(this,(typeof key==='object')?key:(function(){var items={};items[key]=value;return items}()))}},true);global.extend({setCurrentRenderer:global.renderer.setDefault,render:function(){var argsT=['swfUrl','id','width','height','renderAt','dataSource','dataFormat'],params={},i;if(arguments[0]instanceof global.core){arguments[0].render();return arguments[0]}for(i=0;(i<arguments.length&&i<argsT.length);i+=1){params[argsT[i]]=arguments[i]}if(typeof arguments[arguments.length-1]==='object'){delete params[argsT[i-1]];global.extend(params,arguments[arguments.length-1])}if(params.dataFormat===undefined){params.dataFormat=FusionChartsDataFormats.XMLURL}return new global.core(params).render()}},false)}());(function(){var global=FusionCharts(['private','DataHandlerManager']);if(global===undefined){return}window.FusionChartsDataFormats={};global.ajax=(function(){var error=function(ajaxApi,x,e,args){if(typeof ajaxApi.error==='function'){args[1]=x;Array.prototype.push.call(args,e);ajaxApi.error.apply(ajaxApi,args)}};var api={x:window.XMLHttpRequest&&(window.location.protocol!=="file:"||!window.ActiveXObject)?function(){return new window.XMLHttpRequest()}:function(){try{return new window.ActiveXObject("Microsoft.XMLHTTP")}catch(e){throw"Charts cannot render due to lack of AJAX support. Use setDataURL for fallback";}},get:function(u,f){var x=api.x(),args=arguments;x.onreadystatechange=function(){try{if(x.readyState===4){if(x.status===200||x.status===0){f(x.responseText,x)}else{error(api,x,new Error('XMLHttpRequest Error'),args)}}}catch(e){error(api,x,e,args)}};try{if(x.overrideMimeType){x.overrideMimeType('text/plain')}x.open('GET',u,true);x.setRequestHeader('If-Modified-Since','Sat, 29 Oct 1994 19:43:31 GMT');x.setRequestHeader('X-Requested-With','XMLHttpRequest');x.setRequestHeader('Accept','text/plain, */*');x.send(null)}catch(e){error(api,x,e,args)}return x}};return api}());global.ajax.error=function(url,x,method,obj,e){var eventArgs={source:method,url:url,xmlHttpRequestObject:x,error:e,httpStatus:(x&&x.status)?x.status:-1};global.raiseEvent('DataLoadError',eventArgs,obj);if(typeof window.FC_DataLoadError==='function'){window.FC_DataLoadError(obj.id,eventArgs)}};var handlers={},dataStore={},xStore={},cache={},isUrl=/url$/i;var abortAjaxOf=function(id){if(xStore[id]&&typeof xStore[id].abort==='function'&&xStore[id].readyState&&xStore[id].readyState!==0){xStore[id].abort();return true}return false};global.policies.options.dataSource=['dataSource',undefined];global.policies.options.dataFormat=['dataFormat',undefined];global.addDataHandler=function(name,obj){if(typeof name!=='string'||handlers[name.toLowerCase()]!==undefined){global.raiseError(global.core,'03091606','param','::DataManager.addDataHandler',new Error('Invalid Data Handler Name'));return}var api={},lcaseName=name.toLowerCase();handlers[lcaseName]=obj;api['set'+name+'Url']=function(url){return this.setChartDataUrl(url,name)};api['set'+name+'Data']=function(data){return this.setChartData(data,name)};api['get'+name+'Data']=function(){return this.getChartData(name)};window.FusionChartsDataFormats[name]=lcaseName;window.FusionChartsDataFormats[name+'URL']=lcaseName+'URL';global.extend(api,true)};global.addEventListener('BeforeInitialize',function(event){var obj=event.sender;dataStore[obj.id]='';cache[obj.id]={};if(obj.options.dataSource!==undefined&&typeof obj.options.dataFormat==='string'){obj.setChartData(obj.options.dataSource,obj.options.dataFormat)}});global.addEventListener('BeforeDispose',function(e){delete dataStore[e.sender.id];delete cache[e.sender.id];abortAjaxOf(e.sender.id)});global.extend({setChartDataUrl:function(url,format,silent){if(format===undefined||format===null||typeof format.toString!=='function'){global.raiseError(global.core,'03091609','param','.setChartDataUrl',new Error('Invalid Data Format'));return}format=format.toString().toLowerCase();var ps=global.dataUrlParams.join("&");var joinChar;if(null!=ps&&ps.length>0){joinChar=url.indexOf("?")==-1?"?":"&";url=[url,joinChar,ps].join("")}var baseFormat,obj=this,cancelDLRFlag=false;if(isUrl.test(format)){baseFormat=format.slice(0,-3)}else{baseFormat=format;format=format+'url'}global.raiseEvent('DataLoadRequested',{source:'XmlHttpRequest',url:url,dataFormat:baseFormat,cancelDataLoadRequest:function(){cancelDLRFlag=true;this.cancelDataLoadRequest=function(){return false};return true}},obj);if(cancelDLRFlag===true){global.raiseEvent('DataLoadRequestCancelled',{source:'XmlHttpRequest',url:url,dataFormat:baseFormat},obj);return}this.options.dataSource=url;xStore[this.id]=global.ajax.get(decodeURIComponent(url),function(responseText,x){var cancelDLFlag=false;if(cancelDLFlag!==true){obj.setChartData(responseText,baseFormat,silent)}else{global.raiseEvent('DataLoadCancelled',{source:'XmlHttpRequest',url:url,dataFormat:baseFormat,xmlHttpRequestObject:x},obj)}delete xStore[this.id]},'XmlHttpRequest',this)},setChartData:function(data,format,silent){if(format===undefined||format===null||typeof format.toString!=='function'){global.raiseError(global.core,'03091610','param','.setChartData',new Error('Invalid Data Format'))}format=format.toString().toLowerCase();var baseFormat;if(isUrl.test(format)){this.setChartDataUrl(data,format,silent);return}else{this.options.dataSource=data;baseFormat=format}this.options.dataFormat=format;var handler=handlers[baseFormat],parseResult,eventArgs,cancelDUFlag=false;if(typeof handler==='undefined'){global.raiseError(global.core,'03091611','param','.setChartData',new Error('Data Format not recognized'));return}parseResult=handler.encode(data,this);parseResult.format=baseFormat;eventArgs={dataFormat:baseFormat,dataSource:data,dataError:parseResult.error,data:parseResult.data,cancelDataUpdate:function(){cancelDUFlag=true;this.cancelDataUpdate=function(){return false};return true}};global.raiseEvent('BeforeDataUpdate',eventArgs,this);delete eventArgs.cancelDataUpdate;if(cancelDUFlag===true){global.raiseEvent('DataUpdateCancelled',eventArgs,this);return}dataStore[this.id]=(parseResult.data=eventArgs.data)||'';cache[this.id]={};if(silent!==true){if(this.options.safeMode===true&&this.__state.rendering===true&&!this.isActive()){this.__state.updatePending=parseResult;global.raiseWarning(this,'23091255','run','::DataHandler~update','Renderer update was postponed due to async loading.')}else{delete this.__state.updatePending;global.renderer.update(this,parseResult)}}global.raiseEvent('DataUpdated',eventArgs,this)},getChartData:function(format,advanced){var handler,parseResult;if(format===undefined||typeof format.toString!=='function'||(handler=handlers[format=format.toString().toLowerCase()])===undefined){global.raiseError(this,'25081543','param','~getChartData()',new Error('Unrecognized data-format specified in "format"'));return undefined}parseResult=(typeof cache[this.id][format]==='object')?cache[this.id][format]:cache[this.id][format]=handler.decode(dataStore[this.id],this);return Boolean(advanced)===true?parseResult:parseResult.data}},true);global.extend({transcodeData:function(data,from,to,advanced){if(!from||typeof from.toString!=='function'||!to||typeof to.toString!=='function'||handlers[(to=to.toString().toLowerCase())]===undefined||handlers[(from=from.toString().toLowerCase())]===undefined){global.raiseError(this,'14090217','param','transcodeData()',new Error('Unrecognized data-format specified during transcoding.'));return undefined}var l1=handlers[from].encode(data,this),l2=handlers[to].decode(l1.data,this);if(!(l2.error instanceof Error)){l2.error=l1.error}return advanced?l2:l2.data}},false);global.core.addEventListener('Disposed',function(e){delete cache[e.sender.id]});global.core.addEventListener('Loaded',function(e){var obj=e.sender;if(obj instanceof global.core&&obj.__state.updatePending!==undefined){global.renderer.update(obj,obj.__state.updatePending);delete obj.__state.updatePending}})}());(function(){var global=FusionCharts(['private','GenericRuntime']);if(global===undefined){return}var SCRIPT_NAME_REGEX=/(fusioncharts\.js|fusioncharts\.debug\.js|fusioncharts\.core\.js|fusioncharts\.min\.js|fusioncharts\.packed\.js)(\?.*)?$/i;var alias={vled:'realtimeverticalled'};global.core.options.scriptBaseUri=(function(){var scripts=document.getElementsByTagName('script'),l=scripts.length,scriptBaseUri='',i;for(i=0;i<l;i+=1){if(SCRIPT_NAME_REGEX.test(scripts[i].getAttribute('src'))){scriptBaseUri=scripts[i].getAttribute('src').split(SCRIPT_NAME_REGEX)[0];break}}return scriptBaseUri}());var deconstructPolicySet=function(policies,options,obj){for(var policy in policies){if(policies[policy]instanceof Array){options[policies[policy][0]]=obj[policy];continue}for(var prop in policies[policy]){options[policies[policy][prop][0]]=obj[policy][prop]}}},lengthCleanupRegex=/[^\%\d]*$/g,signatureMatchRegex=/^FusionCharts/;global.extend({dispose:function(){global.raiseEvent('BeforeDispose',{},this);delete global.core.items[this.id];global.raiseEvent('Disposed',{},this)},clone:function(params,noCreate){var options=global.extend({},this.args);deconstructPolicySet(global.policies,options,this);deconstructPolicySet(global.renderer.getRendererPolicy(this.options.renderer),options,this);delete options.id;delete options.animate;delete options.stallLoad;if(typeof params==='object'){global.extend(options,params)}return noCreate?options:new global.core(options)},setDataXML:function(xml){if(xml===undefined||xml===null||typeof xml.toString!=='function'){global.raiseError(this,'25081627','param','~setDataXML','Invalid data type for parameter "xml"');return}if(this.ref===undefined||this.ref===null||typeof this.ref.setDataXML!=='function'){this.setChartData(xml.toString(),FusionChartsDataFormats.XML)}else{this.ref.setDataXML(xml.toString())}},setDataUrlParams:function(name,value){global.dataUrlParams[global.dataUrlParams.length]=[name,"=",value].join("")},setDataURL:function(url){if(url===undefined||url===null||typeof url.toString!=='function'){global.raiseError(this,'25081724','param','~setDataURL','Invalid data type for parameter "url"');return}if(this.ref===undefined||this.ref===null||typeof this.ref.setDataURL!=='function'){this.setChartData(url.toString(),FusionChartsDataFormats.XMLURL)}else{this.ref.setDataURL(url.toString())}},isActive:function(){if(!this.ref||document.getElementById(this.id)!==this.ref||typeof this.ref.signature!=='function'){return false}try{return signatureMatchRegex.test(this.ref.signature())}catch(e){return false}},resizeTo:function(w,h,noUpdate){var dimension={width:w,height:h};if(typeof arguments[0]==='object'){dimension.width=arguments[0].width;dimension.height=arguments[0].height;noUpdate=h}if(dimension.width&&typeof dimension.width.toString==='function'){this.width=dimension.width.toString().replace(lengthCleanupRegex,'')}if(dimension.height&&typeof dimension.height.toString==='function'){this.height=dimension.height.toString().replace(lengthCleanupRegex,'')}if(noUpdate!==true){global.renderer.resize(this,dimension)}},chartType:function(){var url=this.src.substring(this.src.indexOf('.swf'),0),file=url.substring(url.lastIndexOf('/')+1).toLowerCase();return alias[file]===undefined?file:alias[file]}},true);window.getChartFromId=function(id){return global.core.items[id]instanceof global.core?global.core.items[id].ref:global.swfobject.getObjectById(id)};var jsCall=function(obj,prop){if(typeof obj[prop]==='function'){return function(){return obj[prop].apply(obj,arguments)}}return obj[prop]};global.addEventListener('internal.DOMElementCreated',function(event,args){if(args.ref===undefined||args.success!==true){return}var ignore={options:true,vars:true,attributes:true,params:true,src:true,ref:true,constructor:true,setDataXML:true,setDataURL:true,hasRendered:true,getXML:true,getDataAsCSV:true,print:true,exportChart:true,signature:true,link:true};for(var prop in event.sender){if(ignore[prop]===true||args.ref[prop]!==undefined){continue}try{args.ref[prop]=jsCall(event.sender,prop)}catch(e){}}})}());(function(){var global=FusionCharts(['private','DynamicChartAttributes']);if(global===undefined){return}global.extend({setChartAttribute:function(attributes){if(arguments.length>1&&typeof attributes==='string'){var temp=arguments[0];attributes={};attributes[temp]=arguments[1]}else if(attributes===null||typeof attributes!=='object'){return}var i=0,json=this.getChartData(FusionChartsDataFormats.JSON),prop,attList=json.chart||json.graph||{};for(prop in attributes){i+=1;attList[prop.toLowerCase()]=attributes[prop]}if(i>0){if(typeof attList.animation==='undefined'){attList.animation='0'}this.setChartData(json,FusionChartsDataFormats.JSON)}},getChartAttribute:function(attribute){var attList=(attList=this.getChartData(FusionChartsDataFormats.JSON)).chart||attList.graph;if(arguments.length===0||attribute===undefined||attList===undefined){return attList}var value,i;if(typeof attribute==='string'){value=attList[attribute.toString().toLowerCase()]}else if(attribute instanceof Array){value={};for(i=0;i<attribute.length;i+=1){value[attribute[i]]=attList[attribute[i].toString().toLowerCase()]}}else{global.raiseError(this,'25081429','param','~getChartAttribute()','Unexpected value of "attribute"')}return value}},true)}());(function(){var global=FusionCharts(['private','Flash_Renderer']);if(global===undefined){return}var swfobject=global.swfobject=function(){var UNDEF="undefined",OBJECT="object",SHOCKWAVE_FLASH="Shockwave Flash",SHOCKWAVE_FLASH_AX="ShockwaveFlash.ShockwaveFlash",FLASH_MIME_TYPE="application/x-shockwave-flash",EXPRESS_INSTALL_ID="SWFObjectExprInst",ON_READY_STATE_CHANGE="onreadystatechange",win=window,doc=document,nav=navigator,plugin=false,domLoadFnArr=[main],regObjArr=[],objIdArr=[],listenersArr=[],storedAltContent,storedAltContentId,storedCallbackFn,storedCallbackObj,isDomLoaded=false,isExpressInstallActive=false,dynamicStylesheet,dynamicStylesheetMedia,autoHideShow=true,ua=function(){var w3cdom=typeof doc.getElementById!=UNDEF&&typeof doc.getElementsByTagName!=UNDEF&&typeof doc.createElement!=UNDEF,u=nav.userAgent.toLowerCase(),p=nav.platform.toLowerCase(),windows=p?/win/.test(p):/win/.test(u),mac=p?/mac/.test(p):/mac/.test(u),webkit=/webkit/.test(u)?parseFloat(u.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):false,ie=!+"\v1",playerVersion=[0,0,0],d=null;if(typeof nav.plugins!=UNDEF&&typeof nav.plugins[SHOCKWAVE_FLASH]==OBJECT){d=nav.plugins[SHOCKWAVE_FLASH].description;if(d&&!(typeof nav.mimeTypes!=UNDEF&&nav.mimeTypes[FLASH_MIME_TYPE]&&!nav.mimeTypes[FLASH_MIME_TYPE].enabledPlugin)){plugin=true;ie=false;d=d.replace(/^.*\s+(\S+\s+\S+$)/,"$1");playerVersion[0]=parseInt(d.replace(/^(.*)\..*$/,"$1"),10);playerVersion[1]=parseInt(d.replace(/^.*\.(.*)\s.*$/,"$1"),10);playerVersion[2]=/[a-zA-Z]/.test(d)?parseInt(d.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0}}else if(typeof win.ActiveXObject!=UNDEF){try{var a=new ActiveXObject(SHOCKWAVE_FLASH_AX);if(a){try{d=a.GetVariable("$version")}catch(e){}if(d){ie=true;d=d.split(" ")[1].split(",");playerVersion=[parseInt(d[0],10),parseInt(d[1],10),parseInt(d[2],10)]}}}catch(e){}}return{w3:w3cdom,pv:playerVersion,wk:webkit,ie:ie,win:windows,mac:mac}}(),onDomLoad=function(){if(!ua.w3){return}if((typeof doc.readyState!=UNDEF&&doc.readyState=="complete")||(typeof doc.readyState==UNDEF&&(doc.getElementsByTagName("body")[0]||doc.body))){callDomLoadFunctions()}if(!isDomLoaded){if(typeof doc.addEventListener!=UNDEF){doc.addEventListener("DOMContentLoaded",callDomLoadFunctions,false)}if(ua.ie&&ua.win){doc.attachEvent(ON_READY_STATE_CHANGE,function(){if(doc.readyState=="complete"){doc.detachEvent(ON_READY_STATE_CHANGE,arguments.callee);callDomLoadFunctions()}});if(win==top){(function(){if(isDomLoaded){return}try{doc.documentElement.doScroll("left")}catch(e){setTimeout(arguments.callee,0);return}callDomLoadFunctions()})()}}if(ua.wk){(function(){if(isDomLoaded){return}if(!/loaded|complete/.test(doc.readyState)){setTimeout(arguments.callee,0);return}callDomLoadFunctions()})()}addLoadEvent(callDomLoadFunctions)}}();function callDomLoadFunctions(){if(isDomLoaded){return}try{var t=doc.getElementsByTagName("body")[0].appendChild(createElement("span"));t.parentNode.removeChild(t)}catch(e){return}isDomLoaded=true;var dl=domLoadFnArr.length;for(var i=0;i<dl;i++){domLoadFnArr[i]()}}function addDomLoadEvent(fn){if(isDomLoaded){fn()}else{domLoadFnArr[domLoadFnArr.length]=fn}}function addLoadEvent(fn){if(typeof win.addEventListener!=UNDEF){win.addEventListener("load",fn,false)}else if(typeof doc.addEventListener!=UNDEF){doc.addEventListener("load",fn,false)}else if(typeof win.attachEvent!=UNDEF){addListener(win,"onload",fn)}else if(typeof win.onload=="function"){var fnOld=win.onload;win.onload=function(){fnOld();fn()}}else{win.onload=fn}}function main(){if(plugin){testPlayerVersion()}else{matchVersions()}}function testPlayerVersion(){var b=doc.getElementsByTagName("body")[0];var o=createElement(OBJECT);o.setAttribute("type",FLASH_MIME_TYPE);var t=b.appendChild(o);if(t){var counter=0;(function(){if(typeof t.GetVariable!=UNDEF){var d;try{d=t.GetVariable("$version")}catch(e){}if(d){d=d.split(" ")[1].split(",");ua.pv=[parseInt(d[0],10),parseInt(d[1],10),parseInt(d[2],10)]}}else if(counter<10){counter++;setTimeout(arguments.callee,10);return}b.removeChild(o);t=null;matchVersions()})()}else{matchVersions()}}function matchVersions(){var rl=regObjArr.length;if(rl>0){for(var i=0;i<rl;i++){var id=regObjArr[i].id;var cb=regObjArr[i].callbackFn;var cbObj={success:false,id:id};if(ua.pv[0]>0){var obj=getElementById(id);if(obj){if(hasPlayerVersion(regObjArr[i].swfVersion)&&!(ua.wk&&ua.wk<312)){setVisibility(id,true);if(cb){cbObj.success=true;cbObj.ref=getObjectById(id);cb(cbObj)}}else if(regObjArr[i].expressInstall&&canExpressInstall()){var att={};att.data=regObjArr[i].expressInstall;att.width=obj.getAttribute("width")||"0";att.height=obj.getAttribute("height")||"0";if(obj.getAttribute("class")){att.styleclass=obj.getAttribute("class")}if(obj.getAttribute("align")){att.align=obj.getAttribute("align")}var par={};var p=obj.getElementsByTagName("param");var pl=p.length;for(var j=0;j<pl;j++){if(p[j].getAttribute("name").toLowerCase()!="movie"){par[p[j].getAttribute("name")]=p[j].getAttribute("value")}}showExpressInstall(att,par,id,cb)}else{displayAltContent(obj);if(cb){cb(cbObj)}}}}else{setVisibility(id,true);if(cb){var o=getObjectById(id);if(o&&typeof o.SetVariable!=UNDEF){cbObj.success=true;cbObj.ref=o}cb(cbObj)}}}}}function getObjectById(objectIdStr){var r=null;var o=getElementById(objectIdStr);if(o&&o.nodeName=="OBJECT"){if(typeof o.SetVariable!=UNDEF){r=o}else{var n=o.getElementsByTagName(OBJECT)[0];if(n){r=n}}}return r}function canExpressInstall(){return!isExpressInstallActive&&hasPlayerVersion("6.0.65")&&(ua.win||ua.mac)&&!(ua.wk&&ua.wk<312)}function showExpressInstall(att,par,replaceElemIdStr,callbackFn){isExpressInstallActive=true;storedCallbackFn=callbackFn||null;storedCallbackObj={success:false,id:replaceElemIdStr};var obj=getElementById(replaceElemIdStr);if(obj){if(obj.nodeName=="OBJECT"){storedAltContent=abstractAltContent(obj);storedAltContentId=null}else{storedAltContent=obj;storedAltContentId=replaceElemIdStr}att.id=EXPRESS_INSTALL_ID;if(typeof att.width==UNDEF||(!/%$/.test(att.width)&&parseInt(att.width,10)<310)){att.width="310"}if(typeof att.height==UNDEF||(!/%$/.test(att.height)&&parseInt(att.height,10)<137)){att.height="137"}doc.title=doc.title.slice(0,47)+" - Flash Player Installation";var pt=ua.ie&&ua.win?"ActiveX":"PlugIn",fv="MMredirectURL="+win.location.toString().replace(/&/g,"%26")+"&MMplayerType="+pt+"&MMdoctitle="+doc.title;if(typeof par.flashvars!=UNDEF){par.flashvars+="&"+fv}else{par.flashvars=fv}if(ua.ie&&ua.win&&obj.readyState!=4){var newObj=createElement("div");replaceElemIdStr+="SWFObjectNew";newObj.setAttribute("id",replaceElemIdStr);obj.parentNode.insertBefore(newObj,obj);obj.style.display="none";(function(){if(obj.readyState==4){obj.parentNode.removeChild(obj)}else{setTimeout(arguments.callee,10)}})()}createSWF(att,par,replaceElemIdStr)}}function displayAltContent(obj){if(ua.ie&&ua.win&&obj.readyState!=4){var el=createElement("div");obj.parentNode.insertBefore(el,obj);el.parentNode.replaceChild(abstractAltContent(obj),el);obj.style.display="none";(function(){if(obj.readyState==4){obj.parentNode.removeChild(obj)}else{setTimeout(arguments.callee,10)}})()}else{obj.parentNode.replaceChild(abstractAltContent(obj),obj)}}function abstractAltContent(obj){var ac=createElement("div");if(ua.win&&ua.ie){ac.innerHTML=obj.innerHTML}else{var nestedObj=obj.getElementsByTagName(OBJECT)[0];if(nestedObj){var c=nestedObj.childNodes;if(c){var cl=c.length;for(var i=0;i<cl;i++){if(!(c[i].nodeType==1&&c[i].nodeName=="PARAM")&&!(c[i].nodeType==8)){ac.appendChild(c[i].cloneNode(true))}}}}}return ac}function createSWF(attObj,parObj,id){var r,el=getElementById(id);if(ua.wk&&ua.wk<312){return r}if(el){if(typeof attObj.id==UNDEF){attObj.id=id}if(ua.ie&&ua.win){var att="";for(var i in attObj){if(attObj[i]!=Object.prototype[i]){if(i.toLowerCase()=="data"){parObj.movie=attObj[i]}else if(i.toLowerCase()=="styleclass"){att+=' class="'+attObj[i]+'"'}else if(i.toLowerCase()!="classid"){att+=' '+i+'="'+attObj[i]+'"'}}}var par="";for(var j in parObj){if(parObj[j]!=Object.prototype[j]){par+='<param name="'+j+'" value="'+parObj[j]+'" />'}}el.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+att+'>'+par+'</object>';objIdArr[objIdArr.length]=attObj.id;r=getElementById(attObj.id)}else{var o=createElement(OBJECT);o.setAttribute("type",FLASH_MIME_TYPE);for(var m in attObj){if(attObj[m]!=Object.prototype[m]){if(m.toLowerCase()=="styleclass"){o.setAttribute("class",attObj[m])}else if(m.toLowerCase()!="classid"){o.setAttribute(m,attObj[m])}}}for(var n in parObj){if(parObj[n]!=Object.prototype[n]&&n.toLowerCase()!="movie"){createObjParam(o,n,parObj[n])}}el.parentNode.replaceChild(o,el);r=o}}return r}function createObjParam(el,pName,pValue){var p=createElement("param");p.setAttribute("name",pName);p.setAttribute("value",pValue);el.appendChild(p)}function removeSWF(id){var obj=getElementById(id);if(obj&&obj.nodeName=="OBJECT"){if(ua.ie&&ua.win){obj.style.display="none";(function(){if(obj.readyState==4){removeObjectInIE(id)}else{setTimeout(arguments.callee,10)}})()}else{obj.parentNode.removeChild(obj)}}}function removeObjectInIE(id){var obj=getElementById(id);if(obj){for(var i in obj){if(typeof obj[i]=="function"){obj[i]=null}}obj.parentNode.removeChild(obj)}}function getElementById(id){var el=null;try{el=doc.getElementById(id)}catch(e){}return el}function createElement(el){return doc.createElement(el)}function addListener(target,eventType,fn){target.attachEvent(eventType,fn);listenersArr[listenersArr.length]=[target,eventType,fn]}function hasPlayerVersion(rv){var pv=ua.pv,v=rv.split(".");v[0]=parseInt(v[0],10);v[1]=parseInt(v[1],10)||0;v[2]=parseInt(v[2],10)||0;return(pv[0]>v[0]||(pv[0]==v[0]&&pv[1]>v[1])||(pv[0]==v[0]&&pv[1]==v[1]&&pv[2]>=v[2]))?true:false}function createCSS(sel,decl,media,newStyle){if(ua.ie&&ua.mac){return}var h=doc.getElementsByTagName("head")[0];if(!h){return}var m=(media&&typeof media=="string")?media:"screen";if(newStyle){dynamicStylesheet=null;dynamicStylesheetMedia=null}if(!dynamicStylesheet||dynamicStylesheetMedia!=m){var s=createElement("style");s.setAttribute("type","text/css");s.setAttribute("media",m);dynamicStylesheet=h.appendChild(s);if(ua.ie&&ua.win&&typeof doc.styleSheets!=UNDEF&&doc.styleSheets.length>0){dynamicStylesheet=doc.styleSheets[doc.styleSheets.length-1]}dynamicStylesheetMedia=m}if(ua.ie&&ua.win){if(dynamicStylesheet&&typeof dynamicStylesheet.addRule==OBJECT){dynamicStylesheet.addRule(sel,decl)}}else{if(dynamicStylesheet&&typeof doc.createTextNode!=UNDEF){dynamicStylesheet.appendChild(doc.createTextNode(sel+" {"+decl+"}"))}}}function setVisibility(id,isVisible){if(!autoHideShow){return}var v=isVisible?"visible":"hidden";if(isDomLoaded&&getElementById(id)){getElementById(id).style.visibility=v}else{createCSS("#"+id,"visibility:"+v)}}function urlEncodeIfNecessary(s){var regex=/[\\\"<>\.;]/;var hasBadChars=regex.exec(s)!=null;return hasBadChars&&typeof encodeURIComponent!=UNDEF?encodeURIComponent(s):s}var cleanup=function(){if(ua.ie&&ua.win){window.attachEvent("onunload",function(){var ll=listenersArr.length;for(var i=0;i<ll;i++){listenersArr[i][0].detachEvent(listenersArr[i][1],listenersArr[i][2])}var il=objIdArr.length;for(var j=0;j<il;j++){removeSWF(objIdArr[j])}for(var k in ua){ua[k]=null}ua=null;for(var l in swfobject){swfobject[l]=null}swfobject=null})}}();return{registerObject:function(objectIdStr,swfVersionStr,xiSwfUrlStr,callbackFn){if(ua.w3&&objectIdStr&&swfVersionStr){var regObj={};regObj.id=objectIdStr;regObj.swfVersion=swfVersionStr;regObj.expressInstall=xiSwfUrlStr;regObj.callbackFn=callbackFn;regObjArr[regObjArr.length]=regObj;setVisibility(objectIdStr,false)}else if(callbackFn){callbackFn({success:false,id:objectIdStr})}},getObjectById:function(objectIdStr){if(ua.w3){return getObjectById(objectIdStr)}},embedSWF:function(swfUrlStr,replaceElemIdStr,widthStr,heightStr,swfVersionStr,xiSwfUrlStr,flashvarsObj,parObj,attObj,callbackFn){var callbackObj={success:false,id:replaceElemIdStr};if(ua.w3&&!(ua.wk&&ua.wk<312)&&swfUrlStr&&replaceElemIdStr&&widthStr&&heightStr&&swfVersionStr){setVisibility(replaceElemIdStr,false);addDomLoadEvent(function(){widthStr+="";heightStr+="";var att={};if(attObj&&typeof attObj===OBJECT){for(var i in attObj){att[i]=attObj[i]}}att.data=swfUrlStr;att.width=widthStr;att.height=heightStr;var par={};if(parObj&&typeof parObj===OBJECT){for(var j in parObj){par[j]=parObj[j]}}if(flashvarsObj&&typeof flashvarsObj===OBJECT){for(var k in flashvarsObj){if(typeof par.flashvars!=UNDEF){par.flashvars+="&"+k+"="+flashvarsObj[k]}else{par.flashvars=k+"="+flashvarsObj[k]}}}if(hasPlayerVersion(swfVersionStr)){var obj=createSWF(att,par,replaceElemIdStr);if(att.id==replaceElemIdStr){setVisibility(replaceElemIdStr,true)}callbackObj.success=true;callbackObj.ref=obj}else if(xiSwfUrlStr&&canExpressInstall()){att.data=xiSwfUrlStr;showExpressInstall(att,par,replaceElemIdStr,callbackFn);return}else{setVisibility(replaceElemIdStr,true)}if(callbackFn){callbackFn(callbackObj)}})}else if(callbackFn){callbackFn(callbackObj)}},switchOffAutoHideShow:function(){autoHideShow=false},ua:ua,getFlashPlayerVersion:function(){return{major:ua.pv[0],minor:ua.pv[1],release:ua.pv[2]}},hasFlashPlayerVersion:hasPlayerVersion,createSWF:function(attObj,parObj,replaceElemIdStr){if(ua.w3){return createSWF(attObj,parObj,replaceElemIdStr)}else{return undefined}},showExpressInstall:function(att,par,replaceElemIdStr,callbackFn){if(ua.w3&&canExpressInstall()){showExpressInstall(att,par,replaceElemIdStr,callbackFn)}},removeSWF:function(objElemIdStr){if(ua.w3){removeSWF(objElemIdStr)}},createCSS:function(selStr,declStr,mediaStr,newStyleBoolean){if(ua.w3){createCSS(selStr,declStr,mediaStr,newStyleBoolean)}},addDomLoadEvent:addDomLoadEvent,addLoadEvent:addLoadEvent,getQueryParamValue:function(param){var q=doc.location.search||doc.location.hash;if(q){if(/\?/.test(q)){q=q.split("?")[1]}if(param==null){return urlEncodeIfNecessary(q)}var pairs=q.split("&");for(var i=0;i<pairs.length;i++){if(pairs[i].substring(0,pairs[i].indexOf("="))==param){return urlEncodeIfNecessary(pairs[i].substring((pairs[i].indexOf("=")+1)))}}}return""},expressInstallCallback:function(){if(isExpressInstallActive){var obj=getElementById(EXPRESS_INSTALL_ID);if(obj&&storedAltContent){obj.parentNode.replaceChild(storedAltContent,obj);if(storedAltContentId){setVisibility(storedAltContentId,true);if(ua.ie&&ua.win){storedAltContent.style.display="block"}}if(storedCallbackFn){storedCallbackFn(storedCallbackObj)}}isExpressInstallActive=false}}}}();global.core.options.requiredFlashPlayerVersion='8';global.core.options.installRedirectMessage='You need Adobe Flash '+'Player 8 (or above) to view the charts on this page. It is a free, '+'lightweight and safe installation from Adobe Systems Incorporated.'+'\n\nWould you like to go to Adobe\'s website and install Flash Player?';var noFlashRedirectNotified=false;var checkBadChars=/[\\\"<>;]/;var urlEncodeIfNecessary=function(s){return(checkBadChars.exec(s)!==null)&&typeof window.encodeURIComponent!==undefined?window.encodeURIComponent(s):s};var syncDataStore=function(e,a){if(a&&a.source==='XmlHttpRequest'){return}var obj=e.sender;if(obj.ref&&typeof obj.ref.dataInvokedOnSWF==='function'&&obj.ref.dataInvokedOnSWF()&&typeof obj.ref.getXML==='function'){global.raiseWarning(obj,'08300116','run','::DataHandler~__fusioncharts_vars','Data was set in UTF unsafe manner');obj.setChartData(window.unescape(e.sender.ref.getXML({escaped:true})),FusionChartsDataFormats.XML,true);obj.flashVars.dataXML=obj.getChartData(FusionChartsDataFormats.XML);delete obj.flashVars.dataURL}e.sender.removeEventListener('DataLoaded',syncDataStore)};window.__fusioncharts_dimension=(function(){var isPercentRegex=/.*?\%\s*?$/g;return function(id){var obj,parent;return!((obj=global.core(id))instanceof global.core&&obj.ref&&(parent=obj.ref.parentNode))?{}:{width:parent.offsetWidth*(isPercentRegex.test(obj.width)?parseInt(obj.width,10)/100:1),height:parent.offsetHeight*(isPercentRegex.test(obj.height)?parseInt(obj.height,10)/100:1)}}}());window.__fusioncharts_vars=function(id,vars){var obj=global.core.items[id];if(!(obj instanceof global.core)){global.raiseError(global.core,'25081621','run','::FlashRenderer','FusionCharts Flash object is accessing flashVars of non-existent object.');return false}if(typeof vars==='object'){if(obj.ref&&typeof obj.ref.dataInvokedOnSWF==='function'&&obj.ref.dataInvokedOnSWF()){if(vars.dataURL!==undefined){obj.addEventListener('DataLoaded',syncDataStore)}else if(vars.dataXML!==undefined){vars.dataXML=window.unescape(vars.dataXML)}}else{delete vars.dataURL;delete vars.dataXML}global.extend(obj.flashVars,vars);return true}return obj.flashVars};global.addEventListener('BeforeInitialize',function(event){var obj=event.sender;if(obj.options.renderer!=='flash'){return}if(obj.width===undefined){obj.width=global.renderer.policies.flashVars.chartWidth[1]}if(obj.height===undefined){obj.height=global.renderer.policies.flashVars.chartHeight[1]}if(obj.flashVars.DOMId===undefined){obj.flashVars.DOMId=obj.id}global.extend(obj.flashVars,{registerWithJS:'1',chartWidth:obj.width,chartHeight:obj.height,InvalidXMLText:'Invalid data.'});if(Boolean(obj.options.autoInstallRedirect)===true&&!global.swfobject.hasFlashPlayerVersion(global.core.options.requiredFlashPlayerVersion.toString())&&noFlashRedirectNotified===false){noFlashRedirectNotified=true;if(window.confirm(global.core.options.installRedirectMessage)){window.location.href='http://get.adobe.com/flashplayer/'}}if(obj.options.dataFormat===undefined&&obj.options.dataSource===undefined){obj.options.dataFormat=FusionChartsDataFormats.XMLURL;obj.options.dataSource='Data.xml'}});global.addEventListener('Disposed',function(e){if(e.sender.options.renderer!=='flash'){return}global.swfobject.removeSWF(e.sender.id)});global.addEventListener('Loaded',function(e){if(e.sender.options.renderer!=='flash'){return}e.sender.flashVars.animation='0'});global.addEventListener('DataLoadRequested',function(event,args){var obj=event.sender;if(obj.options.renderer!=='flash'){return}if(window.location.protocol==='file:'&&args.dataFormat===FusionChartsDataFormats.XML&&Boolean(obj.options.safeMode)===true){if(obj.ref&&obj.ref.setDataURL){obj.ref.setDataURL(args.url,false)}else{obj.flashVars.dataURL=args.url}event.stopPropagation();args.cancelDataLoadRequest();obj.addEventListener('DataLoaded',syncDataStore)}if(obj.ref&&typeof obj.showChartMessage==='function'){delete obj.flashVars.stallLoad;obj.ref.showChartMessage('XMLLoadingText')}else{obj.flashVars.stallLoad=true}});global.addEventListener('DataLoadRequestCancelled',function(event){var obj=event.sender;if(obj.options.renderer!=='flash'){return}if(obj.ref&&typeof obj.showChartMessage==='function'){obj.ref.showChartMessage()}delete obj.flashVars.stallLoad});global.addEventListener('DataLoadError',function(event,args){var obj=event.sender;if(obj.options.renderer!=='flash'){return}if(obj.ref&&typeof obj.ref.showChartMessage==='function'&&args.source==='XmlHttpRequest'){obj.ref.showChartMessage('LoadDataErrorText')}else{delete obj.flashVars.dataURL;obj.flashVars.dataXML='<JSON parsing error>';delete obj.flashVars.stallLoad}});global.addEventListener('DataLoadRequestCompleted',function(event,args){var obj=event.sender;if(obj.options.renderer!=='flash'||args.source!=='XmlHttpRequest'){return}delete obj.flashVars.stallLoad});window.__fusioncharts_event=function(event,args){setTimeout(function(){global.raiseEvent(event.type,args,global.core.items[event.sender])},0)};var renderer={dataFormat:'xml',init:function(){},policies:{params:{scaleMode:['scaleMode','noScale'],scale:['scaleMode','noScale'],wMode:['wMode','opaque'],menu:['menu',undefined],bgColor:['bgColor',undefined],allowScriptAccess:['allowScriptAccess','always'],quality:['quality','best'],swLiveConnect:['swLiveConnect',undefined],base:['base',undefined],align:['align',undefined],salign:['sAlign',undefined]},flashVars:{lang:['lang','EN'],debugMode:['debugMode',undefined],animation:['animate',undefined]},options:{autoInstallRedirect:['autoInstallRedirect',false]}},render:function(container,callBack){if(Boolean(this.flashVars.animation)===true){delete this.flashVars.animation}if(!this.src){global.raiseError(this,'03102348','run','::FlashRenderer.render','Could not find a valid "src" attribute. swfUrl or chart '+'type missing.')}var encodedVars={},dataXML=this.flashVars.dataXML,dataURL=this.flashVars.dataURL;global.extend(encodedVars,this.flashVars);if(this.flashVars.stallLoad===true){if(this.options.dataFormat===FusionChartsDataFormats.XML){dataXML=this.options.dataSource}if(this.options.dataFormat===FusionChartsDataFormats.XMLURL){dataURL=this.options.dataSource}}encodedVars.dataXML=window.encodeURIComponent(dataXML||'');encodedVars.dataURL=urlEncodeIfNecessary(dataURL||'');global.swfobject.embedSWF(this.src,this.id,this.width,this.height,'8.0.0',undefined,encodedVars,this.params,this.attributes,callBack)},update:function(vars){var chart=this.ref,data=vars.data;this.flashVars.dataXML=data;if(vars.error===undefined){if(this.isActive()&&typeof chart.setDataXML==='function'){chart.setDataXML(data,false)}else{delete this.flashVars.dataURL;delete this.flashVars.animation}}else{if(this.isActive()&&typeof chart.showChartMessage==='function'){chart.showChartMessage('InvalidXMLText')}else{this.flashVars.dataXML='<Invalid'+vars.format.toUpperCase()+'>';delete this.flashVars.dataURL;delete this.flashVars.animation}}},resize:function(){this.flashVars.chartWidth=this.width;this.flashVars.chartHeight=this.height;if(this.ref!==undefined){this.ref.width=this.width;this.ref.height=this.height;if(typeof this.ref.resize==='function'){this.ref.resize(this.ref.offsetWidth,this.ref.offsetHeight)}}},config:function(items){global.extend(this.flashVars,items)}};renderer.prototype={getSWFHTML:function(){var outElm=document.createElement('span'),inElm=document.createElement('span'),tempId='RnVzaW9uQ2hhcnRz'+(new Date()).getTime();outElm.appendChild(inElm);inElm.setAttribute('id',tempId);outElm.style.display='none';document.getElementsByTagName('body')[0].appendChild(outElm);global.swfobject.embedSWF(this.src,tempId,this.width,this.height,'8.0.0',undefined,this.flashVars,this.params,this.attrs);var html=outElm.innerHTML.replace(tempId,this.id);global.swfobject.removeSWF(tempId);outElm.parentNode.removeChild(outElm);return html},setTransparent:function(transparency){if(typeof transparency!=='boolean'&&transparency!==null){transparency=true}this.params.wMode=transparency===null?'window':(transparency===true?'transparent':'opaque')},addVariable:global.core.prototype.configure};global.renderer.register('flash',renderer);if(!/\(iPhone;|\(iPad;/i.test(navigator.userAgent)){global.renderer.setDefault('flash')}}());(function(){var global,FCC={},baseURL='JSClass/',covertToFCC,renderArray=[],FCCready=false,i,scriptTags,jsConf={};global=FusionCharts(['private','Canvas_Renderer']);if(global===undefined){return}var FCCCREDITSTATE=true;function noEffect(){return undefined}FCC.init=function(){var passThroughStyle=function(name,suf,pref){return function(value,obj){obj.style[name]=(pref?pref:'')+value+(suf?suf:'')}},FCFCC={color:["AFD8F8","F6BD0F","8BBA00","FF8E46","008E8E","D64646","8E468E","588526","B3AA00","008ED6","9D080D","A186BE","CC6600","FDC689","ABA000","F26D7D","FFF200","0054A6","F7941C","CC3300","006600","663300","6DCFF6"],seriesName:{'Column2D':1,'Column3D':1,'Line':1,'Area2D':1,'Bar2D':1,'Pie2D':1,'Pie3D':1,'Doughnut2D':1,'Doughnut3D':1,'Pareto2D':1.5,'Pareto3D':1.5,'MSColumn2D':2,'MSColumn3D':2,'MSLine':2,'ZoomLine':2.5,'MSBar2D':2,'MSBar3D':2,'MSArea':2,'InverseMSLine':2.2,'InverseMSColumn2D':2.2,'InverseMSArea':2.2,'StackedColumn3D':3,'Marimekko':3,'StackedColumn2D':3,'StackedColumn2DLine':3,'StackedColumn3DLine':3,'StackedBar2D':3,'StackedBar3D':3,'StackedArea2D':3,'MSCombi3D':4,'MSCombi2D':4,'MSCombiDY2D':5,'MSColumnLine3D':4,'MSColumn3DLineDY':5,'MSStackedColumn2D':6,'MSStackedColumn2DLineDY':6.5,'StackedColumn3DLineDY':5.5,'Scatter':7,'Bubble':7.5,'ScrollColumn2D':2,'ScrollLine2D':2,'ScrollArea2D':2,'ScrollStackedColumn2D':3,'ScrollCombi2D':4,'ScrollCombiDY2D':5,'SSGrid':9,'Spline':1,'SplineArea':1,'MSSpline':2,'MSSplineArea':2,'MultiAxisLine':8},highCharts:{'Column2D':'column','Column3D':'column','Line':'line','Area2D':'area','Bar2D':'bar','Pie2D':'pie','Pie3D':'pie','Doughnut2D':'pie','Doughnut3D':'pie','Pareto2D':'column','Pareto3D':'column','MSColumn2D':'column','MSColumn3D':'column','MSLine':'line','ZoomLine':'line','MSBar2D':'bar','MSBar3D':'bar','MSArea':'area','InverseMSLine':'line','InverseMSColumn2D':'column','InverseMSArea':'area','StackedColumn3D':'column','StackedColumn2D':'column','Marimekko':'column','StackedColumn2DLine':'column','StackedColumn3DLine':'column','StackedBar2D':'bar','StackedBar3D':'bar','StackedArea2D':'area','MSCombi3D':'column','MSCombi2D':'column','MSCombiDY2D':'column','MSColumnLine3D':'column','MSColumn3DLineDY':'column','MSStackedColumn2D':'','MSStackedColumn2DLineDY':'','StackedColumn3DLineDY':'column','Scatter':'scatter','Bubble':'scatter','ScrollColumn2D':'column','ScrollLine2D':'line','ScrollArea2D':'area','ScrollStackedColumn2D':'column','ScrollCombi2D':'column','ScrollCombiDY2D':'column','SSGrid':'','Spline':'spline','SplineArea':'areaspline','MSSpline':'spline','MSSplineArea':'areaspline','MultiAxisLine':''},combi:{'column2d':'column','column3d':'column','line':'line','area':'area'},valueAbs:{'Pie2D':true,'Pie3D':true,'Doughnut2D':true,'Doughnut3D':true,'Marimekko':true},exportFormat:{png:'image/png',jpg:'image/jpeg',pdf:'application/pdf',svg:'image/svg+xml'},JSONconf:{blankChart:{chart:{events:{},margin:[0,0,0,0]},credits:{href:'http://www.fusioncharts.com?BS=FCHSEvalMark',text:'FusionCharts - HighCharts',enabled:FCCCREDITSTATE},legend:{enabled:false},title:{text:'No data to display',style:{fontFamily:'Verdana',fontSize:'10px',color:'#666666'}},plotOptions:{series:{}},exporting:{enabled:false}}},commonMethodCSV:'saveAsImage,print,exportChart,getXML,getChartAttribute,getDataAsCSV,hasRendered,signature,cancelExport',methodCSV:{'pie3d':',togglePieSlice','pie2d':',togglePieSlice','doughnut2D':',togglePieSlice','doughnut3D':',togglePieSlice','mscombi3d':',view2D,view3D,resetView,rotateView,getViewAngles,fitToStage','zoomline':',zoomTo,setZoomMode,zoomOut,resetChart'},method:{getExternalInterfaceMethods:function(chartType){return FCFCC.commonMethodCSV+(FCFCC.methodCSV[chartType||this.FusionCharts.chartType()]||'')},print:function(){var id=this.id;FCC.items[id].FCCObj.FCC.print()},exportChart:function(conf){var id=this.id,HCConf={},HCObj=FCC.items[id].FCCObj.FCC;if(HCObj.options.exporting.enabled){if(typeof conf==='object'){for(var x in conf){if(x.toLowerCase()==='exportformat'&&FCFCC.exportFormat[conf[x].toLowerCase()]){HCConf.type=FCFCC.exportFormat[conf[x].toLowerCase()]}else if(x.toLowerCase()==='exportfilename'){HCConf.filename=conf[x]}}}HCObj.exportChart(HCConf)}},getXML:function(){var id=this.id;return global.core.items[id].getXMLData()},signature:function(){return'FusionCharts/3.2.0/JS'},hasRendered:function(){var id=this.id;if(typeof FCC.items[id]==='object'){return true}else{return false}},togglePieSlice:function(index){if(this.ref&&this.ref.FCC&&this.ref.FCC.series&&this.ref.FCC.series[0]&&this.ref.FCC.series[0].data&&this.ref.FCC.series[0].data[index]&&this.ref.FCC.series[0].data[index].slice()){this.ref.FCC.series[0].data[index].slice()}}},supportedStyle:{font:function(HC,toObj,style){var styleobject,x,map={font:passThroughStyle('font-family'),size:passThroughStyle('font-size','px'),color:passThroughStyle('color',undefined,'#'),align:function(value,obj){obj.align=value},bgColor:passThroughStyle('background-color',undefined,'#'),borderColor:passThroughStyle('border-color',undefined,'#'),isHTML:'',leftMargin:passThroughStyle('margin-left','px'),letterSpacing:passThroughStyle('letter-spacing','px'),bold:function(value,obj){obj['font-weight']=value=='1'?'bold':'normal'},italic:function(value,obj){obj['font-style']=value=='1'?'italic':'normal'},underline:function(value,obj){obj['text-decoration']=value=='1'?'underline':'normal'}};switch(toObj){case'caption':styleobject=HC.title;break;case'datalabels':styleobject=HC.xAxis.labels;break;case'datavalues':styleobject=HC.plotOptions.series.dataLabels;break;case'subcaption':styleobject=HC.subtitle;break;case'tooltip':styleobject=HC.tooltip;break;case'trendvalues':styleobject=undefined;break;case'xaxisname':styleobject=HC.xAxis.title;break;case'yaxisname':styleobject=HC.yAxis[0].title;break;case'yaxisvalues':styleobject=HC.yAxis[0].labels;break;default:break}if(typeof styleobject==='object'){for(x in style){if(typeof map[x]==='function'){map[x](style[x],styleobject)}}}}}};var chartMessageStore={};function margeClone(obj1,obj2){var item;if(typeof obj1!=='object'&&typeof obj2!=='object'){return null}if(typeof obj1!=='object'){obj1={}}if(typeof obj2!=='object'){obj2=obj1;obj1={}}if(obj2 instanceof Array){for(item=0;item<obj2.length;item+=1){if(typeof obj2[item]!=='object'){obj1[item]=obj2[item]}else{obj1[item]=margeClone(obj1[item],obj2[item])}}}else{for(item in obj2){if(typeof obj2[item]!=='object'){obj1[item]=obj2[item]}else{obj1[item]=margeClone(obj1[item],obj2[item])}}}return obj1}FCC.prototype={setTransparent:function(transparency){if(!this.jsVars){this.jsVars={}}if(typeof transparency!=='boolean'&&transparency!==null){transparency=true}this.jsVars.transparent=transparency;if(typeof jQuery==='function'){jQuery('#'+this.id).css('background-color',(transparency===true)?'':'#FFFFFF')}},getSWFHTML:noEffect,_overrideJSChartConfiguration:function(conf){jsConf[this.id]=conf}};if(global.core.options&&global.core.options.scriptBaseUri!==undefined){baseURL=global.core.options.scriptBaseUri}else{scriptTags=document.getElementsByTagName('script');if(scriptTags){for(i=0;i<scriptTags.length;i+=1){if(scriptTags[i].src.indexOf('FusionCharts.js')!==-1){baseURL=scriptTags[i].src.split("FusionCharts.js")[0]}}}}FCC.isReady=function(){return FCCready};FCC.items={};function loadScript(src){var newele=document.createElement('script');newele.setAttribute('type','text/javascript');newele.setAttribute('src',src);var head=document.getElementsByTagName('head');head[0].appendChild(newele)}function checkFCCReady(){var temp;if(typeof window.Highcharts==='object'){FCCready=true;if(typeof FCC.render=='function'){while(renderArray.length>0){temp=renderArray.splice(0,1)[0];FCC.render.call(temp[0],temp[1],temp[2])}}}else{setTimeout(checkFCCReady,300)}}function loadFCC(){if(typeof jQuery==='function'){jQuery.noConflict();if($===undefined){$=jQuery}if(typeof window.Highcharts!=='object'){loadScript(baseURL+'highcharts.js');setTimeout(checkFCCReady,300)}else{checkFCCReady()}}else{setTimeout(loadFCC,300)}}if(typeof jQuery!=='function'){loadScript(baseURL+'jquery.min.js');setTimeout(loadFCC,300)}else{loadFCC()}var getAxisLimits=function(maxValue,minValue,yAxisMaxValue,yAxisMinValue,stopMaxAtZero,setMinAsZero){var maxPowerOfTen,minPowerOfTen,powerOfTen,y_interval,rangePowerOfTen,rangeInterval,y_topBound,y_lowerBound,yMaxGiven,yMinGiven,yMax,yMin,range,interval;maxValue=(typeof maxValue!=='number')?0.1:maxValue;minValue=(typeof minValue!=='number')?0:minValue;if((maxValue===minValue)&&(maxValue===0)){maxValue=0.1}if(typeof stopMaxAtZero==='undefined'||typeof stopMaxAtZero==='null'||stopMaxAtZero===''){stopMaxAtZero=false}if(typeof setMinAsZero==='undefined'||typeof setMinAsZero==='null'||setMinAsZero===''){setMinAsZero=true}maxPowerOfTen=Math.floor(Math.log(Math.abs(maxValue))/Math.LN10);minPowerOfTen=Math.floor(Math.log(Math.abs(minValue))/Math.LN10);powerOfTen=Math.max(minPowerOfTen,maxPowerOfTen);y_interval=Math.pow(10,powerOfTen);if(Math.abs(maxValue)/y_interval<2&&Math.abs(minValue)/y_interval<2){powerOfTen-=1;y_interval=Math.pow(10,powerOfTen)}rangePowerOfTen=Math.floor(Math.log(maxValue-minValue)/Math.LN10);rangeInterval=Math.pow(10,rangePowerOfTen);if(((maxValue-minValue)>0)&&((y_interval/rangeInterval)>=10)){y_interval=rangeInterval;powerOfTen=rangePowerOfTen}y_topBound=(Math.floor(maxValue/y_interval)+1)*y_interval;if(minValue<0){y_lowerBound=-1*((Math.floor(Math.abs(minValue/y_interval))+1)*y_interval)}else{if(setMinAsZero){y_lowerBound=0}else{y_lowerBound=Math.floor(Math.abs(minValue/y_interval)-1)*y_interval;y_lowerBound=(y_lowerBound<0)?0:y_lowerBound}}if(stopMaxAtZero&&maxValue<=0){y_topBound=0}if(yAxisMaxValue===null||yAxisMaxValue===undefined||yAxisMaxValue===""){yMaxGiven=false}else{yMaxGiven=true}if(yAxisMinValue===null||yAxisMinValue===undefined||yAxisMinValue===""||typeof Number(yAxisMinValue)==='NaN'){yMinGiven=false}else{yMinGiven=true}if(yMaxGiven===false||(yMaxGiven===true&&Number(yAxisMaxValue)<maxValue)){yMax=y_topBound}else{yMax=Number(yAxisMaxValue)}if(yMinGiven===false||(yMinGiven===true&&Number(yAxisMinValue)>minValue)){yMin=y_lowerBound}else{yMin=Number(yAxisMinValue)}range=Math.abs(yMax-yMin);interval=y_interval;return{Max:yMax,Min:yMin,Range:range,interval:interval}};function createContainer(contanerId,chartId,width,height,cleanCopy){var container=document.getElementById(chartId),__container=document.getElementById(contanerId),lengthPercentageRegExp=/\%\s*?$/ig;if(cleanCopy===true){if(container){__container.removeChild(container)}container=document.createElement('div');container.setAttribute('id',chartId);__container.appendChild(container)}for(var x in this.attributes){container[x]=this.attributes[x]}if(this.attributes['class']){container.className=this.attributes['class']}container.setAttribute('style','display: inline-block; zoom: 1; *display: inline;');container.style.width=width+(width.match(lengthPercentageRegExp)?'':'px');container.style.height=height+(height.match(lengthPercentageRegExp)?'':'px')}function removeChart(id,deleteDom){if(FCC.items[id]){if(FCC.items[id].FCCObj&&FCC.items[id].FCCObj.FCC){FCC.items[id].FCCObj.FCC.destroy()}clearTimeout(FCC.items[id].timeChach);if(deleteDom===true){var refObj=FCC.items[id].FCCObj;if(refObj&&refObj.parentNode){refObj.parentNode.removeChild(refObj)}}delete FCC.items[id]}}function createSeries(FCtype,color,type,name,yAxis,showvalue,linecolor,linethickness,marker){return{data:[],FCtype:FCtype,color:color,type:type,name:name?name:' ',yAxis:yAxis?1:undefined,showvalue:showvalue,lineColor:linecolor,lineWidth:linethickness,marker:marker}}function parseStr(str){if(typeof str==='string'){return str.replace(/\{br\}/ig,'<br/>')}else{return''}}function createMsg(id,msgTxt,event){var HCJson=FCFCC.JSONconf.blankChart;HCJson.title.y=parseInt(document.getElementById(id).offsetHeight,10)/2;HCJson.chart.renderTo=id;HCJson.title.text=chartMessageStore[id][msgTxt]?chartMessageStore[id][msgTxt]:msgTxt;if(typeof event==='string'){global.raiseEvent(event,{},global.core.items[id])}return HCJson}function showChartMessage(msg){var id=this.id,HCJson,FC=global.core.items[id];if(FC.ref){chartMessageStore[id].msgTxt=msg;FC.ref.FCC.destroy();HCJson=createMsg(id,'msgTxt',undefined);FC.ref.FCC=new Highcharts.Chart(HCJson);FCC.items[id].baseObj=HCJson}if(FC.link.root===FC){return}var config=global.extend({show:true},this.FusionCharts.link.parent.options.overlayButton);global.extend(config,this.FusionCharts.link.parent.link.configuration().overlayButton||{});this.drawOverlayButton(config)}function drawOverlayButton(conf){if(conf.show){var back=document.createElement('span');back.innerHTML=conf.message?conf.message:"Back";back.style.border='1px solid #'+(conf.borderColor?conf.borderColor:"7f8975");back.style.backgroundColor='#'+(conf.bgColor?conf.bgColor:"edefec");back.style.fontFamily=conf.font?conf.font:"Verdana";back.style.color='#'+conf.fontColor?conf.fontColor:"49563a";back.style.fontSize=(conf.fontSize?conf.fontSize:'10')+'px';back.style.padding=(conf.padding?conf.padding:'3')+'px';back.style.fontWeight=parseInt(conf.bold,10)===0?'normal':'bold';back.style.position='absolute';back.style.top='1px';back.style.right='1px';back.style._cursor='hand';back.style.cursor='pointer';back.onclick=(function(sender){return function(){global.raiseEvent('OverlayButtonClick',{},sender.FusionCharts)}}(this));document.getElementById(this.id).childNodes[0].appendChild(back)}}function getSeriesName(chartName){return FCFCC.seriesName[chartName]}function convertColor(color,alpha,rgba){var R=0,G=0,B=0,colorStr,tempArr;if(rgba&&rgba.match(/^rgba/ig)){tempArr=rgba.split(',');R=tempArr[0].slice(tempArr[3].indexOf('(')+1);G=tempArr[1];B=tempArr[2];if(!alpha){alpha=parseInt(tempArr[3].slice(0,tempArr[3].indexOf(')')),10)*100}}if(color){colorStr=color.replace(/[#\s]/ig,'').split(',')[0];switch(colorStr.length){case 3:colorStr=colorStr[0]+colorStr[0]+colorStr[1]+colorStr[1]+colorStr[2]+colorStr[2];break;case 6:break;default:colorStr=(colorStr+'FFFFFF').slice(0,6);break}R=parseInt(colorStr.slice(0,2),16);G=parseInt(colorStr.slice(2,4),16);B=parseInt(colorStr.slice(4,6),16)}if(!alpha){alpha=100}if(typeof alpha==='string'){alpha=alpha.split(',')[0]}alpha=parseInt(alpha,10)/100;return'rgba('+R+','+G+','+B+','+alpha+')'}var getCordinate=function(x,y,width,height,angle){x=x?x:0;y=y?y:0;width=(typeof width!=='undefined')?width:400;height=(typeof height!=='undefined')?height:400;angle=(typeof angle!=='undefined')?angle:0;var x1,x2,y1,y2,tan,temp;tan=Math.tan((angle*Math.PI)/180);y1=Math.round(height/2-((width/2)*tan));x1=Math.round(width/2-((height/2)/tan));x1=(x1<0)?0:x1;x1=(x1>width)?width:x1;y1=(y1<0)?0:y1;y1=(y1>height)?height:y1;x2=width-x1;y2=height-y1;if(angle>90&&angle<=270){temp=y1;y1=y2;y2=temp}if(angle>180&&angle<=360){temp=x1;x1=x2;x2=temp}return[x1+x,y1+y,x2+x,y2+y]};var fillGcolorPoint=function(bgColor,bgAlpha,bgRatio){var x,first,count=0,blendAt,rgb,alpha,colorStop=[];bgAlpha=bgAlpha?bgAlpha.split(","):undefined;bgRatio=bgRatio?bgRatio.split(","):undefined;bgColor=bgColor.split(",");first=(typeof bgRatio==='object')?bgRatio[0]:undefined;for(x=0;x<bgColor.length;x+=1){rgb=bgColor[x];blendAt=bgRatio?bgRatio[x]:undefined;alpha=bgAlpha?bgAlpha[x]:100;alpha=alpha?alpha:100;if(!blendAt){first=1;blendAt=(x!==0)?((100-count)/(bgColor.length-x)):0}if(first){count+=parseInt(blendAt,10)}else{count=parseInt(blendAt,10)}if(count>=100){colorStop.push([1,convertColor(rgb,alpha)]);break}else{colorStop.push([count/100,convertColor(rgb,alpha)])}}return colorStop};var CreateColor=function(x,y,width,height,angle,bgColor,bgAlpha,bgRatio){var colorObj={};colorObj.linearGradient=getCordinate(x,y,width,height,angle);colorObj.stops=fillGcolorPoint(bgColor,bgAlpha,bgRatio);if('\v'==='v'){if(2*colorObj.linearGradient[0]>width){colorObj.stops.reverse();for(var i=0;i<colorObj.stops.length;i+=1){colorObj.stops[i][0]=1-colorObj.stops[i][0]}}if(colorObj.stops[colorObj.stops.length-1][0]!==1){colorObj.stops.push([1,colorObj.stops[colorObj.stops.length-1][1]])}if(colorObj.stops[0][0]!==0){colorObj.stops.splice(0,0,[0,colorObj.stops[0][1]])}}return colorObj};var convertNames=function(chartName){return FCFCC.highCharts[chartName]};var paretoConvert=function(data){var x,psum=0,pareto={yAxis:1,data:[],type:'line',color:'rgba(00,00,00,1)',FCtype:1.5},sum=0;if(data instanceof Array){for(x=0;x<data.length;x+=1){sum+=data[x].y}for(x=0;x<data.length;x+=1){psum+=data[x].y;pareto.data.push({y:Math.round((psum/sum)*10000)/100})}}return pareto};var convertSWFtoAlias=function(swf){var alias=swf.substring(swf.indexOf('.swf'),0);return alias.substring(alias.lastIndexOf('/')+1)};var formatNumber=function(num,obj,type){type=type===undefined?1:type;var chart={formatnumber:1,formatnumberscale:1,defaultnumberscale:'',numberscaleunit:'K,M',numberscalevalue:'1000,1000',numberprefix:"",numbersuffix:"",decimalseparator:".",thousandseparator:",",indecimalseparator:"",inthousandseparator:"",decimals:"",forcedecimals:"0",yaxisvaluedecimals:"",sformatnumber:"1",sformatnumberscale:"0",sdefaultnumberscale:"",snumberscaleunit:"K,M",snumberscalevalue:"1000,1000",snumberprefix:"",snumbersuffix:"",sdecimals:"",sforcedecimals:"0",syaxisvaluedecimals:"0"};var numberScaleValue,numberScaleUnit,result,i,res,power,formatedNum='',c=0,initialVal,decimalVal,splitVal,decimalLength,last;for(i in obj){chart[i.toLowerCase()]=obj[i]}num=chart.indecimalseparator!==''?num.toString().replace(chart.indecimalseparator,'.'):num;num=chart.inthousandseparator!==''?num.toString().replace(chart.inthousandseparator,''):num;if(type!==1){chart.formatnumber=chart.sformatnumber;chart.formatnumberscale=chart.sformatnumberscale;chart.defaultnumberscale=chart.sdefaultnumberscale;chart.numberscaleunit=chart.snumberscaleunit;chart.numberscalevalue=chart.snumberscalevalue;chart.numberprefix=chart.snumberprefix;chart.numbersuffix=chart.snumbersuffix;chart.decimals=chart.sdecimals;chart.forcedecimals=chart.sforcedecimals;chart.yaxisvaluedecimals=chart.syaxisvaluedecimals}numberScaleValue=chart.numberscalevalue.split(',');numberScaleUnit=chart.numberscaleunit.split(',');result=res=num.toString();if(chart.formatnumber==1){if(res.indexOf('.')!==-1){splitVal=res.split('.');initialVal=splitVal[0];decimalVal='.'+splitVal[1]}else{initialVal=res;decimalVal=''}for(i=initialVal.length;i>0;i-=1){if(c%3===0&&c!==0){formatedNum=chart.thousandseparator+formatedNum;c=0}formatedNum=res.charAt(i-1)+formatedNum;c+=1}result=(splitVal===undefined)||(decimalVal===0)?formatedNum:formatedNum+decimalVal}if(chart.formatnumberscale==1){res=num;for(i=0;i<numberScaleValue.length&&res/numberScaleValue[i]>=1;i+=1){res=res/numberScaleValue[i]}i-=1;if(chart.decimals===''){chart.decimals='2'}power=Math.pow(10,chart.decimals);result=(i===-1)?Math.round(res*power)/power:Math.round(res*power)/power}if(chart.forcedecimals==1){if(result.toString().indexOf(chart.decimalseparator)!==-1){decimalVal=result.toString().split(chart.decimalseparator)[1];decimalLength=decimalVal.length}else{decimalLength=0}if(decimalLength===0){result+=chart.decimalseparator}if(decimalLength>chart.decimals){if(chart.decimals==1&&decimalVal[0]>=5){last=result[result.substring(0,result.indexOf('.')).length-1];last+=1;result=result.substring(0,(result.indexOf('.')-1))+last;result=result+'.'+'0'}else if(decimalVal[chart.decimals-1]>=5){last=decimalVal[chart.decimals]>=5?(parseInt(decimalVal[chart.decimals-1],10)+1):decimalVal[chart.decimals-1];decimalVal=decimalVal.substring(0,chart.decimals-1)+last;result=result.substring(0,result.indexOf('.'))+'.'+decimalVal}}else{while(decimalLength<chart.decimals){result+='0';decimalLength+=1}}}if(chart.formatnumberscale==1){result+=(i===-1)?chart.defaultnumberscale:numberScaleUnit[i]}result=chart.numberprefix+result+chart.numbersuffix;if(chart.decimalseparator!=="."&&chart.decimalseparator!==""){result=result.toString().replace('.',chart.decimalseparator)}return result};var convertAncorSide=function(num){var x='circle';switch(num){case 3:x='triangle';break;case 4:x='diamond';break;default:x='square';break}if(isNaN(num)){x='circle'}return x};var newwindow;var pointClick=function(flag,unescape){var link='',arr,chartId,sender;if((flag===2&&this.link)||(flag===1&&this.options.chart.link)){if(flag===2&&this.link){link=unescape=='0'?this.link:window.decodeURIComponent(this.link);link.replace(/^[\s]*/,'');arr=this.link.split('-');chartId=this.options.id;sender=global.core.items[chartId]}else if(flag===1&&this.options.chart.link){link=unescape=='0'?this.options.chart.link:window.decodeURIComponent(this.options.chart.link);link.replace(/^[ ]*/,'');arr=this.options.chart.link.split('-');chartId=this.options.chart.renderTo;sender=global.core.items[chartId]}switch(arr[0].toLowerCase()){case'n':window.open(arr[1]);break;case'f':if(frames[arr[1]]){frames[arr[1]].location=arr[2]}else{window.open(arr[2],arr[1])}break;case'j':try{window[arr[1]](arr[2])}catch(er){}break;case'p':newwindow=window.open(arr[2],arr[1].match(/[^,]+/i),arr[1].replace(/[^,]+,/i,''));if(window.focus){newwindow.focus()}break;case'newchart':var linkType=arr[1].toLowerCase().search('url')!=-1?'URL':FusionChartsDataFormats.JSON,data,x,chartJson,linkchartId;if(linkType==='URL'){data=link.replace(/[^\-]+-[^\-]+-/i,'')}else{chartJson=global.core.items[chartId].getChartData(FusionChartsDataFormats.JSON);linkchartId=link.replace(/[^\-]+-[^\-]+-/i,'');if(chartJson.linkeddata){for(x=0;x<chartJson.linkeddata.length;x+=1){if(chartJson.linkeddata[x].id==linkchartId){data=chartJson.linkeddata[x].linkedchart}}}}global.raiseEvent('LinkedChartInvoked',{linkType:linkType,data:data},sender);break;default:arr=link.split(':');if(arr[0].toLowerCase()=='javascript'){try{eval(arr[1])}catch(err){}}else{window.location.href=link}break}}};var maxZVal=function(obj){var max=0,x,y,temp;if(obj instanceof Array){for(x=0;x<obj.length;x+=1){if(obj[x].data instanceof Array){for(y=0;y<obj[x].data.length;y+=1){temp=parseInt(obj[x].data[y].z,10);max=(max>temp)?max:temp}}}}return max};var maxRedious=function(width,height){var lower,max=5;lower=(width>height)?height:width;if(lower>100){max=lower/8}return max};var createHCJson=function(__containerId,cleanCopy){var width=this.width,height=this.height,chart=convertSWFtoAlias(this.src),id=this.id,jsonObj,container,dataComp,HCJson;removeChart(id,cleanCopy);createContainer.call(this,__containerId,id,width,height,cleanCopy);dataComp=this.getChartData(FusionChartsDataFormats.JSON,true);jsonObj=dataComp.data;if(!FCFCC.highCharts[chart]){HCJson=createMsg(id,'ChartNotSupported','featurenotsupported')}else if(chartMessageStore[id].msgTxt){HCJson=createMsg(id,'msgTxt',undefined)}else if(this.jsVars&&this.jsVars.LoadError){HCJson=createMsg(id,'LoadDataErrorText',undefined)}else if(this.jsVars&&this.jsVars.stallLoad){HCJson=createMsg(id,'XMLLoadingText',undefined)}else if(dataComp.error instanceof Error){HCJson=createMsg(id,'InvalidXMLText','nodatatodisplay')}else{container=document.getElementById(id);HCJson=covertToFCC(id,chart,jsonObj,id,container.offsetWidth,container.offsetHeight);if(HCJson.series.length===0){HCJson=createMsg(id,'NoDataText','nodatatodisplay')}}return HCJson};var addEIMethods=function(ref,obj){if(obj.options.renderer!=='javascript'){return}var eiItems=FCFCC.method.getExternalInterfaceMethods(obj.chartType()).split(','),i;for(i=0;i<eiItems.length;i+=1){if(typeof ref[eiItems[i]]==='function'){continue}if(FCFCC.method[eiItems[i]]===undefined){ref[eiItems[i]]=noEffect}else{ref[eiItems[i]]=FCFCC.method[eiItems[i]]}}};function createChart(callBack,HCJson){var chart=convertSWFtoAlias(this.src),id=this.id;if(!(this.jsVars&&this.jsVars.transparent)){jQuery('#'+this.id).css('background-color','#FFFFFF')}var ref=document.getElementById(id);ref.drawOverlayButton=drawOverlayButton;ref.showChartMessage=showChartMessage;ref.getExternalInterfaceMethods=FCFCC.method.getExternalInterfaceMethods;addEIMethods(ref,this);if(typeof callBack==='function'){try{callBack({success:true,ref:ref,id:id})}catch(err){}}ref.FCC=new Highcharts.Chart(HCJson);var verticalPlotElements=jQuery('.highcharts-grid')[0];var horizontalPlotElements=jQuery('.highcharts-grid')[1];if(verticalPlotElements&&horizontalPlotElements){verticalPlotElements.parentNode.insertBefore(horizontalPlotElements,verticalPlotElements)}FCC.items[id]={'baseObj':HCJson,'FCCObj':ref,'chartType':chart}}var onWindowResize=function(FCCChart,id){var FCObj;clearTimeout(FCCChart.timeChach);FCObj=global.core.items[id];FCCChart.timeChach=setTimeout((function(FCObj){return function(){var id=FCObj.id,__containerId=FCObj.options.containerElementId,HCJson;if(typeof __containerId!=='undefined'&&typeof FCC.items[id]!=='undefined'){HCJson=createHCJson.call(FCObj,__containerId);HCJson.chart.events.load=function(){global.raiseEvent('loaded',{},FCObj);global.raiseEvent('resized',{},FCObj)};HCJson.plotOptions.series.animation=false;createChart.call(FCObj,undefined,HCJson)}}}(FCObj)),500)};var FCCresize=function(){var FCCChart,FCCContainer,id;for(var x in FCC.items){id=x;FCCChart=FCC.items[x];FCCContainer=document.getElementById(x);if(FCCContainer&&(FCCContainer.offsetWidth!=FCCChart.FCCObj.FCC.chartWidth||FCCContainer.offsetHeight!=FCCChart.FCCObj.FCC.chartHeight)){onWindowResize(FCCChart,id)}}};if(window.addEventListener){window.addEventListener("resize",FCCresize,false)}else if(window.attachEvent){window.attachEvent("onresize",FCCresize)}else{window.onresize=FCCresize}var newFCCstub=function(cObj){return{FCconf:{negative:false,stackValue:[]},chart:{alignTicks:false,renderTo:'',ignoreHiddenSeries:false,events:{click:function(){pointClick.call(this,1,cObj.chart.unescapelinks)}},margin:[15,15,50,60],borderRadius:0,plotBackgroundColor:'#FFFFFF'},colors:[],credits:{href:'http://www.fusioncharts.com?BS=FCHSEvalMark',text:'FusionCharts - HighCharts',enabled:FCCCREDITSTATE},global:{},labels:{items:[]},lang:{},legend:{enabled:true,symbolWidth:5,borderRadius:0,itemStyle:{}},loading:{},plotOptions:{series:{borderColor:'#333333',events:{},dataLabels:{enabled:true,color:'#555555',style:{},formatter:function(){var x,y,showvalue=this.point.options.showvalue||this.series.options.showvalue||this.series.chart.options.chart.showvalue;if(this.series.type=='pie'){x=(cObj.chart.showlabels==='0'||!this.point.FCname?'':this.point.FCname);y=showvalue==='1'?(Math.round(this.percentage*100)/100)+(cObj.chart.showpercentagevalues==='1'?'%':''):'';return parseStr(x+(x!==''&&y!==''?cObj.chart.tooltipsepchar:'')+y)}else if(showvalue==='1'){if(this.point.options.displayvalue){x=this.point.options.displayvalue}else{x=formatNumber(this.y,cObj.chart,1);if(this.series.options.FCtype==1.5&&this.series.type=='line'){x=this.y+'%'}if(this.series.options.FCtype==7.5){x=''}}return parseStr(x)}else{return''}}},point:{events:{click:function(){pointClick.call(this,2,cObj.chart.unescapelinks)}}}},area:{states:{hover:{enabled:false}},marker:{lineWidth:1,radius:3,states:{hover:{enabled:false},select:{enabled:false}}}},areaspline:{states:{hover:{enabled:false}},marker:{lineWidth:1,radius:3,states:{hover:{enabled:false},select:{enabled:false}}}},line:{states:{hover:{enabled:false}},marker:{lineWidth:1,radius:3,states:{hover:{enabled:false},select:{enabled:false}}}},spline:{states:{hover:{enabled:false}},marker:{lineWidth:1,radius:3,states:{hover:{enabled:false},select:{enabled:false}}}},pie:{size:'80%',allowPointSelect:true,cursor:'pointer'},column:{}},point:{},series:[{}],subtitle:{text:'',style:{}},symbols:[],title:{text:'',style:{}},toolbar:{},tooltip:{borderRadius:0,style:{},formatter:function(){var x='',charSep=cObj.chart.tooltipsepchar;if(this.point.options.tooltext){x=this.point.options.tooltext}else{if(this.series.options.FCtype>=2&&this.series.name!==' '){x+=this.series.name+charSep}x+=this.x?this.x+charSep:'';if(this.series.options.FCtype==1.5&&this.series.type=='line'){x=this.x+charSep+this.y+'%'}else if(this.series.type=='pie'){x=(this.point.FCname?this.point.FCname+charSep:'')+(Math.round(this.percentage*100)/100)+(cObj.chart.showpercentintooltip==='0'?'':'%')}else if(this.series.options.FCtype===2.5){x=formatNumber(this.y,cObj.chart,1)}else{x+=formatNumber(this.y,cObj.chart,1)}if(this.point.z){x+=charSep+this.point.z}}return parseStr(x)}},xAxis:{labels:{rotation:-25,style:{},formatter:function(){return parseStr(typeof this.value==='string'?this.value:'')},align:'right'},categories:[],plotLines:[],plotBands:[],title:{style:{},text:''}},yAxis:[{startOnTick:false,endOnTick:false,title:{style:{},text:''},labels:{style:{},formatter:function(){return parseStr(formatNumber(this.value,cObj.chart,1))}},plotBands:[],plotLines:[]},{gridLineWidth:0,startOnTick:false,endOnTick:false,title:{style:{},text:''},labels:{style:{},enabled:false,formatter:function(){return parseStr(formatNumber(this.value,cObj.chart,2))}},opposite:true}],exporting:{buttons:{exportButton:{},printButton:{enabled:false}}}}};function addVline(hc,color,alpha,width,value){hc.xAxis.plotLines.push({color:convertColor(color||'#444444',alpha||100),width:width?width:1,value:value})}function addPoint(seriesObj,pointObj,series,chartName,id,HCObj,getScolor,bubbleRatio,FCObj){var x,y,isAbs=FCFCC.valueAbs[chartName],value,seriesType=seriesObj.type||HCObj.chart.defaultSeriesType,dataseperator,tempY,dataYmax,dataYmin,loopMax;if(!seriesObj.yAxis){dataYmax='dataY0max';dataYmin='dataY0min'}else{dataYmax='dataY'+seriesObj.yAxis+'max';dataYmin='dataY'+seriesObj.yAxis+'min'}if(series<7&&series>=2&&series!=2.5){loopMax=HCObj.xAxis.categories.length}else{loopMax=pointObj.length}if(pointObj instanceof Array){for(y=0;y<loopMax;y+=1){if(typeof pointObj[y]==='object'){if(!pointObj[y].vline){if(seriesObj.cursor!='pointer'&&pointObj[y].link){seriesObj.cursor='pointer'}tempY=(isAbs?Math.abs(parseFloat(pointObj[y].value||pointObj[y].y)):parseFloat(pointObj[y].value||pointObj[y].y));if(tempY<0){HCObj.FCconf.negative=true}if(typeof HCObj.FCconf[dataYmax]==='undefined'||tempY>HCObj.FCconf[dataYmax]){HCObj.FCconf[dataYmax]=tempY}if(typeof HCObj.FCconf[dataYmin]==='undefined'||tempY<HCObj.FCconf[dataYmin]){HCObj.FCconf[dataYmin]=tempY}if(typeof HCObj.FCconf.stackValue[y]==='undefined'){HCObj.FCconf.stackValue[y]=tempY}else{HCObj.FCconf.stackValue[y]+=tempY}seriesObj.data.push({y:tempY||0,x:(isAbs?Math.abs(parseFloat(pointObj[y].x)):parseFloat(pointObj[y].x))||undefined,z:(isAbs?Math.abs(parseFloat(pointObj[y].z)):parseFloat(pointObj[y].z))||undefined,color:(series<2||pointObj[y].color||pointObj[y].alpha)?convertColor(pointObj[y].color||(series<2&&getScolor(y)),pointObj[y].alpha,seriesObj.color):undefined,FCname:series<2?pointObj[y].label:undefined,link:pointObj[y].link,sliced:pointObj[y].issliced=='1',id:id,displayvalue:pointObj[y].displayvalue,showvalue:pointObj[y].showvalue,tooltext:pointObj[y].tooltext,marker:(seriesType==='areaspline'||seriesType==='spline'||seriesType==='area'||seriesType==='line')?{enabled:pointObj[y].drawanchors?(pointObj[y].drawanchors=='1'?true:false):undefined,radius:pointObj[y].anchorradius?pointObj[y].anchorradius:undefined,symbol:convertAncorSide(parseInt(pointObj[y].anchorsides,10)),fillColor:pointObj[y].anchorbgcolor?convertColor(pointObj[y].anchorbgcolor||'FFFFFF',pointObj[y].anchorbgalpha||100):undefined,lineColor:pointObj[y].anchorbordercolor?convertColor(pointObj[y].anchorbordercolor||'767575',pointObj[y].anchoralpha||100):undefined,lineWidth:pointObj[y].anchorborderthickness?pointObj[y].anchorborderthickness:undefined}:(series===7.5?{radius:pointObj[y].z?Math.round((pointObj[y].z/bubbleRatio)*10)/10:undefined}:null)});if(series<2){HCObj.xAxis.categories.push(pointObj[y].showlabel==='0'?'':(pointObj[y].label||''))}}else if(series<2){addVline(HCObj,pointObj[y].color,pointObj[y].alpha,pointObj[y].thickness,y-0.5)}}else if(typeof pointObj[y]==='string'&&FCObj.chart.compactdatamode=='1'){dataseperator=FCObj.chart.dataseparator||'|';value=pointObj[y].split(dataseperator);for(x=0;x<value.length;x+=1){tempY=isAbs?Math.abs(parseFloat(value[x])):parseFloat(value[x]);if(tempY<0){HCObj.FCconf.negative=true}if(typeof HCObj.FCconf[dataYmax]==='undefined'||tempY>HCObj.FCconf[dataYmax]){HCObj.FCconf[dataYmax]=tempY}if(typeof HCObj.FCconf[dataYmin]==='undefined'||tempY<HCObj.FCconf[dataYmin]){HCObj.FCconf[dataYmin]=tempY}seriesObj.data.push({y:tempY||0})}}else{seriesObj.data.push({y:0})}}}}function addCategory(obj,series,hc){var x,dataseperator,countCat=0,zoomCat=[];if(obj.categories&&obj.categories[0].category){for(x=0;x<obj.categories[0].category.length;x+=1){if(typeof obj.categories[0].category[x]==='object'){if(!obj.categories[0].category[x].vline){if(series==2.5){zoomCat.push(obj.categories[0].category[x].label?obj.categories[0].category[x].label:'')}else{hc.xAxis.categories.push(obj.categories[0].category[x].label?obj.categories[0].category[x].label:'')}countCat+=1}else{addVline(hc,obj.categories[0].category[x].color,obj.categories[0].category[x].alpha,obj.categories[0].category[x].thickness,countCat-0.5)}}else if(typeof obj.categories[0].category[x]==='string'&&obj.chart.compactdatamode=='1'){dataseperator=obj.chart.dataseparator?obj.chart.dataseparator:'|';if(series==2.5){zoomCat=zoomCat.concat(obj.categories[0].category[x].split(dataseperator))}else{hc.xAxis.categories=hc.xAxis.categories.concat(obj.categories[0].category[x].split(dataseperator))}}}}if(series===2.5){hc.xAxis.maxZoom=2;hc.chart.zoomType='x';hc.chart.showvalue=obj.chart.showvalues==='1'?'1':'0';hc.xAxis.categories=undefined;hc.xAxis.min=0;hc.xAxis.max=zoomCat.length-1;hc.xAxis.endOnTick=false;hc.xAxis.labels.formatter=function(){return parseStr(zoomCat[this.value])}}}function MSStacked(obj,series,chartName,HCObj,width,hight,id,getScolor){var x,y,z,newSeries,count_set=0,max_cat=0,a=[],plotWidth=width-(HCObj.chart.margin[1]+HCObj.chart.margin[3]),plotHight=hight-(HCObj.chart.margin[0]+HCObj.chart.margin[2]),noStack,pointWidth,catWidth,tempheight,maxHight=0,pointValue=0;if(obj.categories&&obj.categories[0]&&obj.categories[0].category){max_cat=obj.categories[0].category.length}if(obj.dataset&&obj.dataset instanceof Array){noStack=obj.dataset.length;catWidth=plotWidth/max_cat;pointWidth=catWidth/(noStack+2);for(x=0;x<obj.dataset.length;x+=1){tempheight=[];if(obj.dataset[x].dataset&&obj.dataset[x].dataset instanceof Array){for(y=0;y<obj.dataset[x].dataset.length;y+=1){newSeries={FCtype:series,type:obj.dataset[x].dataset[y].renderas?FCFCC.combi[obj.dataset[x].dataset[y].renderas.toLowerCase()]:undefined,name:obj.dataset[x].dataset[y].seriesname?obj.dataset[x].dataset[y].seriesname:' ',data:[],color:convertColor(obj.dataset[x].color||getScolor(count_set),obj.dataset[x].dataset[y].alpha||100),yAxis:obj.dataset[x].dataset[y].parentyaxis=='S'?1:undefined,showvalue:obj.dataset[x].dataset[y].showvalues,mColum:x,mStack:y};if(obj.dataset[x].dataset[y].data instanceof Array){for(z=0;z<max_cat;z+=1){tempheight[z]=tempheight[z]?tempheight[z]:0;pointValue=(obj.dataset[x].dataset[y].data[z]&&obj.dataset[x].dataset[y].data[z].value)?parseFloat(obj.dataset[x].dataset[y].data[z].value):'';tempheight[z]+=pointValue?pointValue:0;newSeries.data.push({MWidth:pointWidth,MX:(z*catWidth)+((x+1)*pointWidth),MY:tempheight[z],y:pointValue,link:obj.dataset[x].dataset[y].data[z].link,id:id,color:obj.dataset[x].dataset[y].data[z].color?convertColor(obj.dataset[x].dataset[y].data[z].color||getScolor(count_set),obj.dataset[x].dataset[y].data[z].alpha||100):undefined})}}a.push(newSeries);count_set+=1}}for(z=0;z<max_cat;z+=1){if(maxHight<tempheight[z]){maxHight=tempheight[z]}}}}HCObj.yAxis[0].max=maxHight+5;return a}function addData(obj,series,chartName,hc,width,height,id){var a=[],x,y,z,count_set,getScolor,pareto,yCalTemp;getScolor=function(index){var palett;palett=(obj.chart.palettecolors)?((typeof obj.chart.palettecolors==='string')?obj.chart.palettecolors.split(','):obj.chart.palettecolors):FCFCC.color;return palett[index%palett.length]};switch(series){case 1:case 1.5:if(series==1.5){hc.yAxis[1].max=100;hc.yAxis[1].labels.formatter=function(){return parseStr(this.value+'%')};if(obj.data instanceof Array){obj.data.sort(function(a,b){return parseFloat(b.value)-parseFloat(a.value)})}}hc.legend.enabled=false;if(obj.data){z=createSeries(series);addPoint(z,obj.data,series,chartName,id,hc,getScolor);if(convertNames(chartName)=='pie'){z.data.reverse();z.color=undefined;hc.chart.plotBorderWidth=0;x=hc.chart.borderWidth+1;hc.chart.margin=[hc.chart.margin[0],x,x,x]}a.push(z);if((chartName=='Pareto2D'||chartName=='Pareto3D')&&obj.chart.showcumulativeline!=='0'){pareto=paretoConvert(z.data);a.push(pareto)}}break;case 2:case 2.2:case 2.5:case 3:case 4:case 5:case 5.5:case 6:case 6.5:switch(series){case 2.2:hc.yAxis[0].reversed=true;hc.yAxis[0].PCreversed=true;break;case 3:if(obj.chart.stack100percent=='1'){hc.plotOptions.series.stacking='percent';hc.yAxis[0].labels.formatter=function(){return parseStr(this.value+'%')}}else{hc.plotOptions.series.stacking='normal'}break;case 5.5:hc.plotOptions.column.stacking=obj.chart.stack100percent=='1'?'percent':'normal'}addCategory(obj,series,hc);if(series!==6){if(obj.dataset){count_set=0;for(x=0;x<obj.dataset.length;x+=1){z=createSeries(series,convertColor(obj.dataset[x].color||getScolor(count_set),obj.dataset[x].alpha||100),obj.dataset[x].renderas?FCFCC.combi[obj.dataset[x].renderas.toLowerCase()]:((obj.dataset[x].parentyaxis=='S'&&(series==5||series==5.5))?'line':undefined),obj.dataset[x].seriesname,obj.dataset[x].parentyaxis=='S',obj.dataset[x].showvalues,obj.dataset[x].plotbordercolor?convertColor(obj.dataset[x].plotbordercolor,obj.dataset[x].plotborderalpha||95):undefined,parseInt(obj.dataset[x].plotborderthickness||obj.dataset[x].linethickness,10)||undefined);var seriesType=z.type||hc.chart.defaultSeriesType;z.marker=(seriesType==='area'||seriesType==='line'||seriesType==='spline'||seriesType==='areaspline')?{enabled:obj.dataset[x].drawanchors?(obj.dataset[x].drawanchors=='1'?true:false):undefined,radius:obj.dataset[x].anchorradius?obj.dataset[x].anchorradius:undefined,symbol:convertAncorSide(parseInt(obj.dataset[x].anchorsides,10)),fillColor:obj.dataset[x].anchorbgcolor?convertColor(obj.dataset[x].anchorbgcolor||'FFFFFF',obj.dataset[x].anchorbgalpha||100):undefined,lineColor:obj.dataset[x].anchorbordercolor?convertColor(obj.dataset[x].anchorbordercolor||'767575',obj.dataset[x].anchoralpha||100):undefined,lineWidth:obj.dataset[x].anchorborderthickness?obj.dataset[x].anchorborderthickness:undefined}:null;count_set+=1;if(obj.dataset[x].data){addPoint(z,obj.dataset[x].data,series,chartName,id,hc,undefined,undefined,obj)}a.push(z)}if(series==3||series==5.5||convertNames(chartName)=='bar'){var tempArr=[];for(x=0;x<a.length;x+=1){if(a[x].type){tempArr.push(a[x])}else{tempArr.splice(0,0,a[x])}}a=tempArr;hc.legend.reversed=true}}}else{a=MSStacked(obj,series,chartName,hc,width,height,id,getScolor)}break;case 7:case 7.5:hc.chart.showvalue=obj.chart.showvalues=='1'?'1':'0';if(obj.categories&&obj.categories[0]&&obj.categories[0].category){for(x=0;x<obj.categories[0].category.length;x+=1){if(obj.categories[0].category[x].showverticalline&&obj.categories[0].category[x].showverticalline=='1'){addVline(hc,obj.categories[0].verticallinecolor,obj.categories[0].verticallinealpha,obj.categories[0].verticallinethickness,obj.categories[0].category[x].x)}hc.xAxis.categories[obj.categories[0].category[x].x]=obj.categories[0].category[x].label?obj.categories[0].category[x].label:''}}var bubbleRRatio=maxZVal(obj.dataset)/maxRedious(width,height);if(obj.dataset){count_set=0;for(x=0;x<obj.dataset.length;x+=1){z=createSeries(series,convertColor(obj.dataset[x].color||getScolor(count_set),obj.dataset[x].alpha||100),obj.dataset[x].renderas?FCFCC.combi[obj.dataset[x].renderas]:((obj.dataset[x].parentyaxis=='S'&&(series==5||series==5.5))?'line':undefined),obj.dataset[x].seriesname,obj.dataset[x].parentyaxis=='S',obj.dataset[x].showvalues,undefined,undefined);z.marker={symbol:(series==7.5)?'circle':convertAncorSide(parseInt(obj.dataset[x].anchorsides,10)),states:{hover:{enabled:false}}};count_set+=1;if(obj.dataset[x].data){addPoint(z,obj.dataset[x].data,series,chartName,id,hc,getScolor,bubbleRRatio)}a.push(z)}}hc.xAxis.max=obj.chart.xaxismaxvalue?parseInt(obj.chart.xaxismaxvalue,10):undefined;hc.xAxis.min=obj.chart.xaxisminvalue?parseInt(obj.chart.xaxisminvalue,10):undefined;hc.xAxis.showLastLabel=true;break;default:break}if(!((series===3||series===5.5)&&obj.chart.stack100percent==='1')&&chartName!=='Marimekko'){if(series===3||series===5.5){hc.FCconf.dataY0max=hc.FCconf.stackValue[0];hc.FCconf.dataY0min=hc.FCconf.stackValue[0];for(y=1;y<hc.FCconf.stackValue.length;y+=1){if(hc.FCconf.stackValue[y]>hc.FCconf.dataY0max){hc.FCconf.dataY0max=hc.FCconf.stackValue[y]}if(hc.FCconf.stackValue[y]<hc.FCconf.dataY0min){hc.FCconf.dataY0min=hc.FCconf.stackValue[y]}}}if(series===1.5||series===5.5||series===5||series===6.5){yCalTemp=getAxisLimits(hc.FCconf.dataY0max,hc.FCconf.dataY0min,obj.chart.pyaxismaxvalue,obj.chart.pyaxisminvalue,'',obj.chart.setadaptiveymin!=='1');hc.yAxis[0].max=yCalTemp.Max;hc.yAxis[0].min=yCalTemp.Min;if(series!==1.5){yCalTemp=getAxisLimits(hc.FCconf.dataY1max,hc.FCconf.dataY1min,obj.chart.syaxismaxvalue,obj.chart.syaxisminvalue,'',obj.chart.setadaptivesymin!=='1');hc.yAxis[1].max=yCalTemp.Max;hc.yAxis[1].min=yCalTemp.Min}}else{yCalTemp=getAxisLimits(hc.FCconf.dataY0max,hc.FCconf.dataY0min,obj.chart.yaxismaxvalue,obj.chart.yaxisminvalue,'',obj.chart.setadaptiveymin!=='1');hc.yAxis[0].max=yCalTemp.Max;hc.yAxis[0].min=yCalTemp.Min}}hc.series=a}function ModyfyLegend(hc,obj){var noSeries=hc.series.length,legendPos,legendWidth,legendHeight;if(obj.chart.showlegend=='0'){hc.legend.enabled=false}else{hc.legend.labelFormatter=function(){return parseStr(this.name)};if(obj.chart.interactivelegend=='0'){hc.plotOptions.series.events.legendItemClick=function(event){return false};hc.legend.itemStyle.cursor='default'}hc.legend.shadow=obj.chart.legendshadow=='0'?false:true;hc.legend.backgroundColor=convertColor(obj.chart.legendbgcolor||'#ffffff',obj.chart.legendbgalpha||100);hc.legend.borderColor=convertColor(obj.chart.legendbordercolor||'#545454',obj.chart.legendborderalpha||100);hc.legend.borderWidth=obj.chart.legendborderthickness||1;if(obj.reverselegend=='1'){hc.legend.reversed=!hc.legend.reversed}if(obj.chart.legendposition=='RIGHT'){hc.legend.verticalAlign='middle';hc.legend.align='right';hc.legend.width=70;hc.legend.x=-15;hc.chart.margin[1]+=85}else{hc.legend.x=0;hc.chart.margin[2]+=46}}}function createText(text,top,left){return{html:text,style:{left:left+'px',top:top+'px'}}}function convertMarimeko(HCObj,FCObj,chartWidth,chartHight,FCCategories){var plotWidth=chartWidth-(HCObj.chart.margin[1]+HCObj.chart.margin[3]),plotHight=chartHight-(HCObj.chart.margin[0]+HCObj.chart.margin[2]),y,z,arr=[],total=0,temp,setPersent=false,catCountFlag=true,temp2,totalpercent=0;if(HCObj.xAxis.labels.enabled===false&&FCObj.chart.showxaxispercentvalues!='0'){HCObj.xAxis.title.margin+=15;HCObj.chart.margin[2]+=15}if(HCObj.xAxis.labels.enabled!==false&&FCObj.chart.showxaxispercentvalues!='0'){plotHight+=15}if(FCCategories&&FCCategories[0]&&FCCategories[0].category instanceof Array){temp=0;for(y=0;y<FCCategories[0].category.length;y+=1){if(FCCategories[0].category[y].widthpercent){temp+=parseFloat(FCCategories[0].category[y].widthpercent)}else{break}}if(y===FCCategories[0].category.length&&Math.round(temp)===100){setPersent=true}}for(y=0;y<HCObj.series.length;y+=1){for(z=0;z<HCObj.series[y].data.length;z+=1){if(typeof HCObj.series[y].data[z]=='object'){temp=parseFloat(HCObj.series[y].data[z].y)}else{temp=parseFloat(HCObj.series[y].data[z])}arr[z]=arr[z]?arr[z]+temp:temp;total+=temp}}for(y=0;y<HCObj.series.length;y+=1){temp=0;for(z=0;z<HCObj.series[y].data.length;z+=1){if(typeof HCObj.series[y].data[z]!=='object'){HCObj.series[y].data[z]={y:HCObj.series[y].data[z]}}HCObj.series[y].data[z].MX=temp;if(catCountFlag){if(HCObj.xAxis.labels.enabled!==false){HCObj.labels.items.push(createText(HCObj.xAxis.categories[z],plotHight,temp))}if(FCObj.chart.showsum!='0'){HCObj.labels.items.push(createText(formatNumber(arr[z],FCObj.chart),'-14',temp))}}temp2=setPersent?parseFloat(FCCategories[0].category[z].widthpercent)/100:(arr[z]/total);totalpercent+=temp2;temp+=HCObj.series[y].data[z].MWidth=Math.round(plotWidth*temp2);if(catCountFlag&&FCObj.chart.showxaxispercentvalues!='0'&&totalpercent<0.9){HCObj.labels.items.push(createText((Math.round(totalpercent*10000)/100)+'%',plotHight-15,temp-20))}}catCountFlag=false}HCObj.xAxis.labels.enabled=false}function covertToFCC(renderTo,chartname,obj,id,width,hight){var hc,y=getSeriesName(chartname),x,z,l,j,styleName,tempstyle={},styleArr;obj.chart=obj.chart||obj.graph||{};delete obj.graph;obj.chart.tooltipsepchar=obj.chart.tooltipsepchar||',';hc=newFCCstub(obj);hc.chart.renderTo=renderTo;hc.chart.defaultSeriesType=convertNames(chartname);if(hc.chart.defaultSeriesType==='line'||hc.chart.defaultSeriesType==='spline'||hc.chart.defaultSeriesType==='area'||hc.chart.defaultSeriesType==='areaspline'){hc.xAxis.startOnTick=true;hc.xAxis.endOnTick=true;hc.xAxis.showLastLabel=true}hc.plotOptions.series.shadow=obj.chart.showshadow==='1';if(chartname=='Doughnut2D'||chartname=='Doughnut3D'){hc.plotOptions.pie.innerSize='50%'}if(obj.chart.clickurl){hc.chart.link=obj.chart.clickurl;hc.chart.id=id}hc.plotOptions.series.animation=obj.chart.animation==='0'?false:true;if(obj.chart.showlabels=='0'){hc.xAxis.labels.enabled=false;hc.chart.margin[2]=15}if(obj.chart.showyaxisvalues=='0'||obj.chart.showdivlinevalues=='0'||obj.chart.showdivlinevalue=='0'){hc.yAxis[0].labels.enabled=false;hc.chart.margin[3]=15}if(((y==5||y==5.5)&&obj.chart.showyaxisvalues!='0'&&obj.chart.showdivlinesecondaryvalue!='0')||(y===1.5&&obj.chart.showdivlinesecondaryvalue!='0')){hc.yAxis[1].labels.enabled=true;hc.chart.margin[1]=50}hc.xAxis.labels.style={fontFamily:obj.chart.outcnvbasefont||obj.chart.basefont||'Verdana',fontSize:(obj.chart.outcnvbasefontsize||obj.chart.basefontsize||'10')+'px',color:obj.chart.outcnvbasefontcolor||obj.chart.basefontcolor||'#555555'};hc.yAxis[0].labels.style={fontFamily:obj.chart.outcnvbasefont||obj.chart.basefont||'Verdana',fontSize:(obj.chart.outcnvbasefontsize||obj.chart.basefontsize||'10')+'px',color:obj.chart.outcnvbasefontcolor||obj.chart.basefontcolor||'#555555'};hc.yAxis[1].labels.style={fontFamily:obj.chart.outcnvbasefont||obj.chart.basefont||'Verdana',fontSize:(obj.chart.outcnvbasefontsize||obj.chart.basefontsize||'10')+'px',color:obj.chart.outcnvbasefontcolor||obj.chart.basefontcolor||'#555555'};hc.legend.itemStyle={fontFamily:obj.chart.outcnvbasefont||obj.chart.basefont||'Verdana',fontSize:(obj.chart.outcnvbasefontsize||obj.chart.basefontsize||'10')+'px',color:obj.chart.outcnvbasefontcolor||obj.chart.basefontcolor||'#555555'};hc.plotOptions.series.dataLabels.style={fontFamily:obj.chart.basefont||'Verdana',fontSize:(obj.chart.basefontsize||'10')+'px',color:obj.chart.basefontcolor||'#555555'};hc.tooltip.style={fontFamily:obj.chart.basefont||'Verdana',fontSize:(obj.chart.basefontsize||'10')+'px',color:obj.chart.basefontcolor||'#555555'};if(obj.chart.drawanchors=='0'){hc.plotOptions.area.marker.enabled=hc.plotOptions.line.marker.enabled=hc.plotOptions.areaspline.marker.enabled=hc.plotOptions.spline.marker.enabled=false;hc.tooltip.enabled=false}if(obj.chart.anchorradius){hc.plotOptions.area.marker.radius=hc.plotOptions.line.marker.radius=hc.plotOptions.areaspline.marker.radius=hc.plotOptions.spline.marker.radius=obj.chart.anchorradius}hc.plotOptions.line.marker.lineColor=hc.plotOptions.areaspline.marker.lineColor=hc.plotOptions.spline.marker.lineColor=convertColor(obj.chart.anchorbordercolor||'767575',obj.chart.anchoralpha||100);hc.plotOptions.area.marker.lineColor=convertColor(obj.chart.anchorbordercolor||'767575',obj.chart.anchoralpha||0);if(obj.chart.anchorborderthickness){hc.plotOptions.area.marker.lineWidth=hc.plotOptions.line.marker.lineWidth=hc.plotOptions.areaspline.marker.lineWidth=hc.plotOptions.spline.marker.lineWidth=obj.chart.anchorborderthickness}hc.plotOptions.line.marker.fillColor=hc.plotOptions.spline.marker.fillColor=convertColor(obj.chart.anchorbgcolor||'FFFFFF',obj.chart.anchorbgalpha||100);hc.plotOptions.area.marker.fillColor=hc.plotOptions.areaspline.marker.fillColor=convertColor(obj.chart.anchorbgcolor||'FFFFFF',obj.chart.anchorbgalpha||0);if(obj.chart.anchorsides){hc.plotOptions.area.marker.symbol=hc.plotOptions.line.marker.symbol=hc.plotOptions.areaspline.marker.symbol=hc.plotOptions.spline.marker.symbol=convertAncorSide(parseInt(obj.chart.anchorsides,10))}hc.plotOptions.line.lineWidth=hc.plotOptions.spline.lineWidth=parseInt(obj.chart.linethickness,10)||(y===1.5?2:3);hc.plotOptions.line.color=hc.plotOptions.spline.color=convertColor(obj.chart.linecolor||'767575',obj.chart.linealpha||100);hc.plotOptions.area.color=hc.plotOptions.areaspline.color=convertColor(obj.chart.plotfillcolor||'767575',obj.chart.plotfillalpha||90);hc.plotOptions.area.lineColor=hc.plotOptions.areaspline.lineColor=convertColor(obj.chart.plotbordercolor||"333333",obj.chart.plotborderalpha||95);hc.plotOptions.area.lineWidth=hc.plotOptions.areaspline.lineWidth=parseInt(obj.chart.plotborderthickness,10)||1;hc.yAxis[0].alternateGridColor=convertColor(obj.chart.alternatehgridcolor||'EEEEEE',obj.chart.alternatehgridalpha||50);hc.yAxis[0].gridLineColor=convertColor(obj.chart.divlinecolor||'717170',obj.chart.divlinealpha||40);hc.yAxis[0].gridLineWidth=obj.chart.divlinethickness?obj.chart.divlinethickness:1;if(obj.chart.caption){hc.title.text=parseStr(obj.chart.caption);hc.chart.margin[0]=35;hc.title.style={fontFamily:obj.chart.outcnvbasefont||obj.chart.basefont||'Verdana',fontSize:'13px','font-weight':'bold',color:obj.chart.outcnvbasefontcolor||obj.chart.basefontcolor||'#555555'}}if(obj.chart.subcaption){hc.subtitle.text=parseStr(obj.chart.subcaption);hc.chart.margin[0]=55;hc.subtitle.style={fontFamily:obj.chart.outcnvbasefont||obj.chart.basefont||'Verdana',fontSize:'11px','font-weight':'bold',color:obj.chart.outcnvbasefontcolor||obj.chart.basefontcolor||'#555555'}}if(obj.chart.xaxisname){hc.xAxis.title.text=parseStr(obj.chart.xaxisname);hc.xAxis.title.margin=hc.chart.margin[2];hc.chart.margin[2]+=20;hc.xAxis.title.style={fontFamily:obj.chart.outcnvbasefont||obj.chart.basefont||'Verdana',fontSize:(obj.chart.outcnvbasefontsize||obj.chart.basefontsize||'10')+'px','font-weight':'bold',color:obj.chart.outcnvbasefontcolor||obj.chart.basefontcolor||'#555555'}}if(y==5||y==5.5||y==1.5){if(obj.chart.pyaxisname){hc.yAxis[0].title.text=parseStr(obj.chart.pyaxisname);hc.yAxis[0].title.margin=hc.chart.margin[3];hc.chart.margin[3]+=20;hc.yAxis[0].title.style={fontFamily:obj.chart.outcnvbasefont||obj.chart.basefont||'Verdana',fontSize:(obj.chart.outcnvbasefontsize||obj.chart.basefontsize||'10')+'px','font-weight':'bold',color:obj.chart.outcnvbasefontcolor||obj.chart.basefontcolor||'#555555'}}if(obj.chart.syaxisname){hc.yAxis[1].title.text=parseStr(obj.chart.syaxisname);hc.yAxis[1].title.margin=hc.chart.margin[1];hc.chart.margin[1]+=20;hc.yAxis[1].title.style={fontFamily:obj.chart.outcnvbasefont||obj.chart.basefont||'Verdana',fontSize:(obj.chart.outcnvbasefontsize||obj.chart.basefontsize||'10')+'px','font-weight':'bold',color:obj.chart.outcnvbasefontcolor||obj.chart.basefontcolor||'#555555'}}}else if(obj.chart.yaxisname){hc.yAxis[0].title.text=parseStr(obj.chart.yaxisname);hc.yAxis[0].title.margin=hc.chart.margin[3];hc.chart.margin[3]+=20;hc.yAxis[0].title.style={fontFamily:obj.chart.outcnvbasefont||obj.chart.basefont||'Verdana',fontSize:(obj.chart.outcnvbasefontsize||obj.chart.basefontsize||'10')+'px','font-weight':'bold',color:obj.chart.outcnvbasefontcolor||obj.chart.basefontcolor||'#555555'}}if(obj.chart.showtooltip=='0'){hc.tooltip.enabled=false}hc.tooltip.backgroundColor=convertColor(obj.chart.tooltipbgcolor||'FFFFFF',obj.chart.tooltipbgalpha||100);hc.tooltip.borderColor=convertColor(obj.chart.tooltipbordercolor||'545454',obj.chart.tooltipborderalpha||100);hc.tooltip.shadow=obj.chart.showtooltipshadow=='1'?true:false;hc.chart.showvalue=obj.chart.showvalues=='0'?'0':'1';if(obj.trendlines){for(x=0;x<obj.trendlines.length;x+=1){if(obj.trendlines[x].line){for(z=0;z<obj.trendlines[x].line.length;z+=1){if(obj.trendlines[x].line[z].istrendzone=='1'){hc.yAxis[0].plotBands.push({color:convertColor(obj.trendlines[x].line[z].color||'333333',obj.trendlines[x].line[z].alpha||99),from:obj.trendlines[x].line[z].startvalue?obj.trendlines[x].line[z].startvalue:0,to:obj.trendlines[x].line[z].endvalue})}hc.yAxis[0].plotLines.push({color:convertColor(obj.trendlines[x].line[z].color||'333333',obj.trendlines[x].line[z].alpha||99),value:obj.trendlines[x].line[z].startvalue?obj.trendlines[x].line[z].startvalue:0,width:obj.trendlines[x].line[z].thickness?obj.trendlines[x].line[z].thickness:1})}}}}if(obj.vtrendlines){for(x=0;x<obj.vtrendlines.length;x+=1){if(obj.vtrendlines[x].line){for(z=0;z<obj.vtrendlines[x].line.length;z+=1){if(obj.vtrendlines[x].line[z].istrendzone!=='0'){hc.xAxis.plotBands.push({color:convertColor(obj.vtrendlines[x].line[z].color||'333333',obj.vtrendlines[x].line[z].alpha||99),from:obj.vtrendlines[x].line[z].startvalue?obj.vtrendlines[x].line[z].startvalue:0,to:obj.vtrendlines[x].line[z].endvalue})}hc.xAxis.plotLines.push({color:convertColor(obj.vtrendlines[x].line[z].color||'333333',obj.vtrendlines[x].line[z].alpha||99),value:obj.vtrendlines[x].line[z].startvalue?obj.vtrendlines[x].line[z].startvalue:0,width:obj.vtrendlines[x].line[z].thickness?obj.vtrendlines[x].line[z].thickness:1})}}}}hc.exporting.enabled=obj.chart.exportenabled=='1'?true:false;hc.exporting.buttons.exportButton.enabled=obj.chart.exportshowmenuitem=='0'?false:true;hc.exporting.filename=obj.chart.exportfilename?obj.chart.exportfilename:'FusionCharts';hc.exporting.width=width;if(obj.styles&&obj.styles.definition instanceof Array&&obj.styles.application instanceof Array){for(j=0;j<obj.styles.definition.length;j+=1){if(typeof FCFCC.supportedStyle[obj.styles.definition[j].type]==='function'){tempstyle[obj.styles.definition[j].name.toLowerCase()]=obj.styles.definition[j]}}for(j=0;j<obj.styles.application.length;j+=1){styleArr=obj.styles.application[j].styles.split(',');for(l=0;l<styleArr.length;l+=1){styleName=styleArr[l].toLowerCase();if(tempstyle[styleName]){FCFCC.supportedStyle[tempstyle[styleName].type](hc,obj.styles.application[j].toobject.toLowerCase(),tempstyle[styleName])}}}}hc.chart.borderWidth=obj.chart.showborder=='0'?0:(obj.chart.borderthickness?obj.chart.borderthickness:1);hc.chart.borderColor=convertColor(obj.chart.bordercolor||'767575',obj.chart.borderalpha||50);hc.chart.plotBorderColor=convertColor(obj.chart.canvasbordercolor||'545454',obj.chart.canvasborderalpha||100);hc.chart.plotBorderWidth=obj.chart.canvasborderthickness?obj.chart.canvasborderthickness:2;hc.plotOptions.series.borderColor=convertColor(obj.chart.plotbordercolor||'333333',obj.chart.plotborderalpha||95);hc.plotOptions.series.borderWidth=obj.chart.showplotborder=='0'?0:(obj.chart.plotborderthickness?obj.chart.plotborderthickness:1);hc.plotOptions.series.borderRadius=obj.chart.useroundedges=='1'?5:0;hc.yAxis[0].plotLines.push({color:convertColor(obj.chart.zeroplanecolor||'717170',obj.chart.zeroplanealpha||80),value:0,width:obj.chart.zeroplanethickness||2});addData(obj,y,chartname,hc,width,hight,id);if(y>=2){ModyfyLegend(hc,obj)}if(typeof jsConf[id]==='object'){hc=margeClone(hc,jsConf[id])}if(chartname=='Marimekko'){hc.plotOptions.series.pointPadding=0;hc.plotOptions.series.groupPadding=0;hc.plotOptions.series.shadow=false;hc.plotOptions.series.dataLabels.y=12;hc.tooltip.formatter=function(){var x='',charSep=obj.chart.tooltipsepchar;x+=this.series.name!==' '?this.series.name+charSep:'';x+=this.x?this.x+charSep:'';if(obj.chart.usepercentdistribution!='0'){x+=(parseInt(this.percentage*100,10)/100)+'%'}else{x+=formatNumber(this.y,obj.chart,1)}return parseStr(x)};if(obj.chart.usepercentdistribution=='0'){hc.plotOptions.series.stacking='normal'}else{hc.plotOptions.series.stacking='percent';hc.yAxis[0].labels.formatter=function(){return parseStr(this.value+'%')}}convertMarimeko(hc,obj,width,hight,obj.categories)}hc.chart.backgroundColor=CreateColor(0,0,width,hight?hight:400,obj.chart.bgangle!==undefined?obj.chart.bgangle:270,obj.chart.bgcolor?obj.chart.bgcolor:"CBCBCB,E9E9E9",obj.chart.bgalpha?obj.chart.bgalpha:"50,50",obj.chart.bgratio?obj.chart.bgratio:"0,100");var plotX,plotY;if('\v'==='v'){plotX=0;plotY=0}else{plotX=hc.chart.margin[3];plotY=hc.chart.margin[0]}hc.chart.plotBackgroundColor=(convertNames(chartname)=='pie')?'rgba(255,255,255,0)':(CreateColor(plotX,plotY,width-(hc.chart.margin[1]+hc.chart.margin[3]),(hight?hight:400)-(hc.chart.margin[0]+hc.chart.margin[2]),obj.chart.canvasbgangle!==undefined?obj.chart.canvasbgangle:0,obj.chart.canvasbgcolor?obj.chart.canvasbgcolor:"FFFFFF",obj.chart.canvasbgalpha?obj.chart.canvasbgalpha:"100",obj.chart.canvasbgratio?obj.chart.canvasbgratio:""));return hc}FCC.dataFormat='json';FCC.render=function(__container,callBack){var HCJson,sender=this,events={loaded:'FC_Loaded',dataloaded:'FC_DataLoaded',rendered:'FC_Rendered',drawcomplete:'FC_DrawComplete'};if(FCC.isReady()){HCJson=createHCJson.call(this,__container.id,true);HCJson.chart.events.load=function(){setTimeout(function(){for(var item in events){global.raiseEvent(item,{},sender);try{if(typeof window[events[item]]==='function'){window[events[item]](sender.id)}}catch(err){setTimeout(function(){throw err;},0)}}},0)};createChart.call(this,callBack,HCJson)}else{renderArray.push([this,__container,callBack])}};FCC.update=function(vars,isResize){var id=this.id,__containerId=this.options.containerElementId,sender=this,HCJson,events={dataloaded:'FC_DataLoaded',drawcomplete:'FC_DrawComplete'};if(typeof __containerId!=='undefined'&&typeof FCC.items[id]!=='undefined'){if(!isResize){delete chartMessageStore[id].msgTxt;if(this.jsVars){delete this.jsVars.stallLoad;delete this.jsVars.LoadError}}HCJson=createHCJson.call(this,__containerId);if(isResize){HCJson.plotOptions.series.animation=false}HCJson.chart.events.load=function(){setTimeout(function(){for(var item in events){global.raiseEvent(item,{},sender);try{if(typeof window[events[item]]==='function'){window[events[item]](sender.id)}}catch(err){setTimeout(function(){throw err;},0)}}},0)};createChart.call(this,undefined,HCJson)}};FCC.resize=function(){FCC.update.call(this,undefined,true)};var chartMessage=function(){};chartMessage.prototype={"LoadDataErrorText":'Error in loading data.',"XMLLoadingText":'Retrieving Data. Please Wait',"InvalidXMLText":'Invalid data.',"NoDataText":'No data to display.',"ReadingDataText":'Reading Data. Please Wait',"ChartNotSupported":'Chart Has No Javascript FallBack'};chartMessage.prototype.constructor=chartMessage;global.addEventListener('Disposed',function(e){delete chartMessageStore[e.sender.id]});global.addEventListener('BeforeInitialize',function(e){chartMessageStore[e.sender.id]=new chartMessage()});FCC.config=function(items){global.extend(chartMessageStore[this.id],items)};global.addEventListener('DataLoadRequested',function(event){var obj=event.sender;if(obj.options.renderer!=='javascript'){return}if(!obj.jsVars){obj.jsVars={}}if(obj.ref&&typeof obj.ref.showChartMessage==='function'){obj.jsVars.stallLoad=true;obj.ref.showChartMessage(chartMessageStore[obj.id].XMLLoadingText)}else{obj.jsVars.stallLoad=true}});global.addEventListener('DataLoadRequestCompleted',function(event,args){var obj=event.sender;if(obj.options.renderer!=='javascript'){return}if(obj.jsVars){delete obj.jsVars.stallLoad;delete obj.jsVars.LoadError}});global.addEventListener('DataLoadError',function(event,args){var obj=event.sender;if(obj.options.renderer!=='javascript'){return}if(!obj.jsVars){obj.jsVars={}}if(obj.ref){obj.jsVars.LoadError=true;obj.ref.showChartMessage(chartMessageStore[obj.id].LoadDataErrorText)}else{obj.jsVars.LoadError=true}});global.addEventListener('BeforeDispose',function(e){if(e.sender.options.renderer!=='javascript'){return}removeChart(e.sender.id,true)})};global.renderer.register('javascript',FCC);if(/\(iPhone;|\(iPod;|\(iPad;/i.test(navigator.userAgent)){global.renderer.setDefault('javascript')}global.extend({'_fallbackJSChartWhenNoFlash':function(){if(!global.swfobject.hasFlashPlayerVersion(global.core.options.requiredFlashPlayerVersion)){global.renderer.setDefault('javascript')}}})}());(function(){var global=FusionCharts(['private','XMLDataHandler']);if(global===undefined){return}var stubCoder=function(data){return{data:data,error:undefined}};global.addDataHandler('XML',{encode:stubCoder,decode:stubCoder})}());if(!this.JSON){this.JSON={}}(function(){function f(n){return n<10?'0'+n:n}if(typeof Date.prototype.toJSON!=='function'){Date.prototype.toJSON=function(a){return isFinite(this.valueOf())?this.getUTCFullYear()+'-'+f(this.getUTCMonth()+1)+'-'+f(this.getUTCDate())+'T'+f(this.getUTCHours())+':'+f(this.getUTCMinutes())+':'+f(this.getUTCSeconds())+'Z':null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(a){return this.valueOf()}}var e=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={'\b':'\\b','\t':'\\t','\n':'\\n','\f':'\\f','\r':'\\r','"':'\\"','\\':'\\\\'},rep;function quote(b){escapable.lastIndex=0;return escapable.test(b)?'"'+b.replace(escapable,function(a){var c=meta[a];return typeof c==='string'?c:'\\u'+('0000'+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+b+'"'}function str(a,b){var i,k,v,length,mind=gap,partial,value=b[a];if(value&&typeof value==='object'&&typeof value.toJSON==='function'){value=value.toJSON(a)}if(typeof rep==='function'){value=rep.call(b,a,value)}switch(typeof value){case'string':return quote(value);case'number':return isFinite(value)?String(value):'null';case'boolean':case'null':return String(value);case'object':if(!value){return'null'}gap+=indent;partial=[];if(Object.prototype.toString.apply(value)==='[object Array]'){length=value.length;for(i=0;i<length;i+=1){partial[i]=str(i,value)||'null'}v=partial.length===0?'[]':gap?'[\n'+gap+partial.join(',\n'+gap)+'\n'+mind+']':'['+partial.join(',')+']';gap=mind;return v}if(rep&&typeof rep==='object'){length=rep.length;for(i=0;i<length;i+=1){k=rep[i];if(typeof k==='string'){v=str(k,value);if(v){partial.push(quote(k)+(gap?': ':':')+v)}}}}else{for(k in value){if(Object.hasOwnProperty.call(value,k)){v=str(k,value);if(v){partial.push(quote(k)+(gap?': ':':')+v)}}}}v=partial.length===0?'{}':gap?'{\n'+gap+partial.join(',\n'+gap)+'\n'+mind+'}':'{'+partial.join(',')+'}';gap=mind;return v}}if(typeof JSON.stringify!=='function'){JSON.stringify=function(a,b,c){var i;gap='';indent='';if(typeof c==='number'){for(i=0;i<c;i+=1){indent+=' '}}else if(typeof c==='string'){indent=c}rep=b;if(b&&typeof b!=='function'&&(typeof b!=='object'||typeof b.length!=='number')){throw new Error('JSON.stringify');}return str('',{'':a})}}if(typeof JSON.parse!=='function'){JSON.parse=function(c,d){var j;function walk(a,b){var k,v,value=a[b];if(value&&typeof value==='object'){for(k in value){if(Object.hasOwnProperty.call(value,k)){v=walk(value,k);if(v!==undefined){value[k]=v}else{delete value[k]}}}}return d.call(a,b,value)}c=String(c);e.lastIndex=0;if(e.test(c)){c=c.replace(e,function(a){return'\\u'+('0000'+a.charCodeAt(0).toString(16)).slice(-4)})}if(/^[\],:{}\s]*$/.test(c.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,'@').replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,']').replace(/(?:^|:|,)(?:\s*\[)+/g,''))){j=eval('('+c+')');return typeof d==='function'?walk({'':j},''):j}throw new SyntaxError('JSON.parse');}}}());var fastTrim=function(str){str=str.replace(/^\s\s*/,'');var ws=/\s/,i=str.length;while(ws.test(str.charAt(i-=1))){}return str.slice(0,i+1)};(function(){var global=FusionCharts(['private','JSON_DataHandler']);if(global===undefined){return}var XSSEncode=function(s){if(s===null||s===undefined||typeof s.toString!=='function'){return''}s=s.toString().replace(/&/g,'&amp;').replace(/\'/g,'&#39;').replace(/\"/g,'&quot;').replace(/</g,'&lt;').replace(/>/g,'&gt;');return s};var xml2json=(function(){var rules={arr:{set:true,trendlines:true,vtrendlines:true,line:true,data:true,dataset:true,categories:true,category:true,linkeddata:true,application:true,definition:true,axis:true},tag:{chart:'linkedchart',map:'linkedmap',graph:'linkedgraph',set:'data',vline:{chart:'data',graph:'data',dataset:'data',categories:'category',linkedchart:'data',linkedgraph:'data'},apply:{application:'application'},style:{definition:'definition'}},attr:{vline:{vline:'true'}},ins:{chart:true,map:true,graph:true},text:{dataset:'data',categories:'category'},group:{styles:{definition:true,application:true}}};var XML_CHILDNODE=1,XML_TEXTNODE=3;var parse={append:function(childObj,obj,nodeName){if(rules.arr[nodeName]===true){if(!(obj[nodeName]instanceof Array)){obj[nodeName]=[]}obj[nodeName].push(childObj)}else{obj[nodeName]=childObj}},child:function(obj,childNode,parentNodeName,baseObj){var i,nodeName,childObj,temp;for(i=0;i<childNode.length;i+=1){nodeName=childNode[i].nodeName.toLowerCase();if(childNode[i].nodeType===XML_CHILDNODE){childObj=parse.attr(childNode[i].attributes);if(rules.ins[nodeName]===true){temp=childObj;childObj={};childObj[nodeName]=temp;temp=undefined}if(typeof rules.attr[nodeName]==='object'){global.extend(childObj,rules.attr[nodeName])}if(typeof rules.tag[nodeName]==='object'&&typeof rules.tag[nodeName][parentNodeName]==='string'){nodeName=rules.tag[nodeName][parentNodeName]}if(typeof rules.tag[nodeName]==='string'){nodeName=rules.tag[nodeName]}if(childNode[i].childNodes.length){if(rules.group[parentNodeName]&&rules.group[parentNodeName][nodeName]){parse.child(obj,childNode[i].childNodes,nodeName,baseObj)}else{parse.child(childObj,childNode[i].childNodes,nodeName,baseObj)}}if(!(rules.group[parentNodeName]&&rules.group[parentNodeName][nodeName])){parse.append(childObj,obj,nodeName)}}else if(childNode[i].nodeType===XML_TEXTNODE&&baseObj.chart&&parseInt(baseObj.chart.compactdatamode,10)&&typeof rules.text[parentNodeName]==='string'){nodeName=rules.text[parentNodeName];childObj=childNode[i].data;parse.append(childObj,obj,nodeName)}}},attr:function(attrObj){var i,obj={};if(!attrObj||!attrObj.length){return obj}for(i=0;i<attrObj.length;i+=1){obj[attrObj[i].nodeName.toLowerCase()]=attrObj[i].nodeValue}return obj}};var parser=function(xml){var jsonObj={},xmlDoc,root,rootName;if(xml===undefined||xml===null||typeof xml.toString!=='function'){parser.errorObject=new TypeError('xml2json.parse()');return jsonObj}xml=xml.toString().replace(/<\!--[\s\S]*?-->/g,'').replace(/<\?xml[\s\S]*?\?>/ig,'').replace(/&(?!([^;\n\r]+?;))/g,'&amp;$1');xml=fastTrim(xml);if(!xml){return jsonObj}if(window.DOMParser){xmlDoc=(new window.DOMParser()).parseFromString(xml,"text/xml")}else{xmlDoc=new ActiveXObject("Microsoft.XMLDOM");xmlDoc.async="false";xmlDoc.loadXML(xml)}if(!(xmlDoc.childNodes.length===1&&(root=xmlDoc.childNodes[0])&&root.nodeName&&(rootName=root.nodeName.toLowerCase())&&(rootName==='chart'||rootName==='map'||rootName==='graph'))){parser.errorObject=new TypeError('xml2json.parse()');return jsonObj}jsonObj[rootName]=parse.attr(root.attributes);if(root.childNodes){parse.child(jsonObj,root.childNodes,rootName,jsonObj)}delete parser.errorObject;return jsonObj};return function(xml){delete parser.errorObject;var jsonData=parser(xml);return{data:jsonData,error:parser.errorObject}}}());var json2xml=(function(){var rules={items:{explode:{data:'set'},attr:{chart:{chart:'chart',graph:'chart'},graph:{graph:'graph',chart:'graph'},map:{map:'map'},linkedchart:{chart:'chart',graph:'graph',map:'map'}},group:{styles:{definition:'style',application:'apply'}}},qualify:function(rule,item,namespace){namespace=namespace.toLowerCase();return typeof this.items[rule][namespace]==='object'?this.items[rule][namespace][item.toLowerCase()]:this.items[rule][namespace]}};var parser=function(obj,namespace){var attrString='',innerXML='',nodeName='',outerXML='',item,qualifier;if(obj instanceof Array){for(item=0;item<obj.length;item+=1){if(typeof obj[item]==='string'){outerXML+=XSSEncode(obj[item])}else{outerXML+=parser(obj[item],namespace)}}}else{for(item in obj){if(obj[item]instanceof Array&&(qualifier=rules.qualify('group',item,namespace))){innerXML+='<'+item+'>'+parser(obj[item],qualifier)+'</'+item+'>'}else if(typeof obj[item]==='object'){if((qualifier=rules.qualify('attr',item,namespace))){nodeName=parser(obj[item],qualifier).replace(/\/\>/ig,'');namespace=item}else{innerXML+=parser(obj[item],item)}}else{if(item.toLowerCase()==='vline'&&Boolean(obj[item])){namespace='vLine'}else{attrString+=' '+item+'=\"'+XSSEncode(obj[item]).toString().replace(/\"/ig,'&quot;')+'\"'}}}if((qualifier=rules.qualify('explode',item,namespace))){namespace=qualifier}outerXML=(nodeName!==''?nodeName:'<'+namespace)+attrString+(innerXML!==''?'>'+innerXML+'</'+namespace+'>':' />')}return outerXML};return function(jsonData){delete parser.errorObject;if(jsonData&&typeof jsonData==='string'){try{jsonData=JSON.parse(jsonData)}catch(e){parser.errorObject=e}}var xmlData=parser(jsonData,jsonData&&jsonData.graph?'graph':'chart');return{data:xmlData,error:parser.errorObject}}}());global.addDataHandler('JSON',{encode:function(data){return json2xml(data)},decode:function(data){return xml2json(data)}})}());(function(){var global=FusionCharts(['private','LinkManager']);if(global===undefined){return}global.policies.link=['link',undefined];var store={};var LinkInformation=function(root,parent){this.items={};this.root=root;this.parent=parent;if(parent instanceof global.core){this.level=this.parent.link.level+1}else{store[root.id]=[{}];this.level=0}};LinkInformation.prototype.configuration=function(){var param=store[this.root.id][this.level]||(store[this.root.id][this.level]={});if(typeof param.id==='undefined'){param.id=store[this.root.id][this.level].id=global.uniqueId()}return param};global.extend({configureLink:function(param,level){if(param instanceof Array){for(var i=0;i<param.length;i+=1){if(typeof store[this.link.root.id][i]!=='object'){store[this.link.root.id][i]={}}global.extend(store[this.link.root.id][i],param[i])}store[this.link.root.id].splice(param.length)}else if(typeof param==='object'){if(typeof level!=='number'){level=this.link.level}if(store[this.link.root.id][level]===undefined){store[this.link.root.id][level]={}}global.extend(store[this.link.root.id][level],param)}else{global.raiseError(this,'25081731','param','~configureLink()','Unable to update link configuration from set parameters')}}},true);global.addEventListener('BeforeInitialize',function(event){if(!(event.sender.link instanceof LinkInformation)){event.sender.link=new LinkInformation(event.sender)}else{if(event.sender.link.parent instanceof global.core){event.sender.link.parent.link.items[event.sender.id]=event.sender}}});global.addEventListener('LinkedChartInvoked',function(event,args){var obj=event.sender,param=obj.clone({dataSource:args.data,dataFormat:args.linkType==='URL'?FusionChartsDataFormats.XMLURL:args.linkType,link:new LinkInformation(obj.link.root,obj)},true);if(obj.args&&parseInt(obj.args.animate,10)!==0){delete param.animate}global.extend(param,obj.link.configuration());global.raiseEvent('BeforeLinkedItemOpen',{level:obj.link.level},obj.link.root);if(global.core.items[param.id]instanceof global.core&&param.strictLinkId===true){global.core.items[param.id].dispose()}var childObj=new global.core(param).render();global.raiseEvent('LinkedItemOpened',{level:obj.link.level,item:childObj},obj.link.root)});global.addEventListener('OverlayButtonClick',function(event){var sender=event.sender,level=sender.link.level-1,parent=sender.link.parent;global.raiseEvent('BeforeLinkedItemClose',{level:level,item:sender},sender.link.root);sender.dispose();global.raiseEvent('LinkedItemClosed',{level:level},sender.link.root);if(!parent.isActive()&&sender.options.containerElement===parent.options.containerElement&&sender.options.insertMode==='replace'){parent.render()}});global.addEventListener('Loaded',function(event){var obj=event.sender;if(!obj||obj.link===undefined){return}if(obj.link.root===obj||!(obj.link.parent instanceof global.core)){return}if(!(obj.ref&&typeof obj.ref.drawOverlayButton==='function')){global.raiseWarning(obj,'04091602','run','::LinkManager^Loaded','Unable to draw overlay button on object. -'+obj.id);return}var config=global.extend({show:true},obj.link.parent.options.overlayButton);global.extend(config,obj.link.parent.link.configuration().overlayButton||{});obj.ref.drawOverlayButton(config)});global.addEventListener('BeforeDispose',function(e){var obj=e.sender;if(!(obj&&obj.link instanceof LinkInformation)){return}if(obj.link.parent instanceof global.core){delete obj.link.parent.link.items[e.sender.id]}delete store[obj.id]});FusionChartsEvents.LinkedItemOpened='linkeditemopened';FusionChartsEvents.BeforeLinkedItemOpen='beforelinkeditemopen';FusionChartsEvents.LinkedItemClosed='linkeditemclosed';FusionChartsEvents.BeforeLinkedItemClose='beforelinkeditemclose'}());(function(){var global=FusionCharts(['private','PrintManager']);if(global===undefined){return}var config={enabled:false,invokeCSS:true,processPollInterval:2000,message:'Chart is being prepared for print.',useExCanvas:false,bypass:false};var lib={getCanvasElementOf:function(obj,width,height){if(obj.__fusioncharts__canvascreated!==true){var canvas=document.createElement('canvas'),identifier=global.core.items[obj.id].attributes['class'];if(config.useExCanvas&&G_vmlCanvasManager){G_vmlCanvasManager.initElement(canvas)}canvas.setAttribute('class',identifier);canvas.__fusioncharts__reference=obj.id;obj.parentNode.insertBefore(canvas,obj.nextSibling);obj.__fusioncharts__canvascreated=true}obj.nextSibling.setAttribute('width',width||obj.offsetWidth||2);obj.nextSibling.setAttribute('height',height||obj.offsetHeight||2);return obj.nextSibling},removeCanvasElementOf:function(obj){if(obj.__fusioncharts__canvascreated!==true||!obj.parentNode||obj.parentNode===null){return}obj.parentNode.removeChild(obj.nextSibling);obj.__fusioncharts__canvascreated=false},rle2rgba:function(rle,rgba,base){if(typeof base!=='string'){base="FFFFFF"}var raw=rle.split(/[;,_]/),run,i,r,g,b,x=0;for(i=0;i<raw.length;i+=2){if(raw[i]===''){raw[i]=base}raw[i]=('000000'+raw[i]).substr(-6);r=parseInt('0x'+raw[i].substring(0,2),16);g=parseInt('0x'+raw[i].substring(2,4),16);b=parseInt('0x'+raw[i].substring(4,6),16);for(run=0;run<raw[i+1];run+=1){rgba[x]=r;rgba[x+1]=g;rgba[x+2]=b;rgba[x+3]=255;x+=4}}return rgba},rle2array:function(rle,base){if(typeof base!=='string'){base="FFFFFF"}var raw=rle.split(';'),run,i;for(run in raw){raw[run]=raw[run].split(/[_,]/);for(i=0;i<raw[run].length;i+=2){raw[run][i]=raw[run][i]===''?base:('000000'+raw[run][i]).substr(-6)}}return raw},drawRLE:function(canvas,rle,width,height,baseColor){width=width||2;height=height||2;canvas.setAttribute('width',width);canvas.setAttribute('height',height);var context=canvas.getContext('2d'),imageData;if(typeof context.putImageData==='function'&&typeof context.createImageData==='function'){imageData=context.createImageData(width,height);lib.rle2rgba(rle,imageData.data,baseColor);context.putImageData(imageData,0,0)}else{imageData=lib.rle2array(rle,baseColor);var x=0,y=0,z=0;for(y in imageData){x=0;for(z=0;z<imageData[y].length;z+=2){context.fillStyle="#"+imageData[y][z];context.fillRect(x,y,imageData[y][z+1],1);x+=parseInt(imageData[y][z+1],10)}}}return true},drawText:function(canvas,text,width,height){var context=canvas.getContext('2d'),w=width||2,h=height||2;context.clearRect(0,0,w,h);context.textBaseline='middle';context.textAlign='center';context.font='8pt verdana';context.fillStyle='#776666';if(typeof context.fillText==='function'){context.fillText(text,w/2,h/2)}else if(typeof context.mozDrawText==='function'){context.translate(w/2,h/2);context.mozDrawText(text)}else{global.raiseWarning(global.core,'25081803','run','::PrintManager>lib.drawText','Canvas text drawing is not supported in browser')}return true},appendCSS:function(css){var el=document.createElement('style');el.setAttribute('type','text/css');if(typeof el.styleSheet==='undefined'){el.appendChild(document.createTextNode(css))}else{el.styleSheet.cssText=css}return document.getElementsByTagName('head')[0].appendChild(el)}};var css={styles:{print:'canvas.FusionCharts{display:none;}@media print{object.FusionCharts{display:none;}canvas.FusionCharts{display:block;}}',error:'canvas.FusionCharts{display:none;}',normal:''},cssNode:undefined,invoke:function(style){if(typeof this.styles[style]!=='undefined'){style=this.styles[style]}if(typeof style!=='undefined'){if(this.cssNode!==undefined&&this.cssNode.parentNode!==undefined){this.cssNode.parentNode.removeChild(this.cssNode)}css.cssNode=lib.appendCSS(style)}}},activeItems={},queuedItems={},activeCount=0,queueTrigger;var onDrawComplete=function(event){var obj=event.sender.ref,w,h;if(obj===undefined||typeof obj.prepareImageDataStream!=='function'||obj.prepareImageDataStream()===false){queueTrigger(event.sender);return}if(!activeItems[event.sender.id]){activeItems[event.sender.id]=obj;activeCount+=1;if(activeCount===1){global.raiseEvent('PrintReadyStateChange',{ready:false,bypass:config.bypass},event.sender)}}try{w=obj.offsetWidth;h=obj.offsetHeight;lib.drawText(lib.getCanvasElementOf(obj,w,h),config.message,w,h)}catch(e){css.invoke('error');global.raiseError(event.sender,'25081807','run','::PrintManager>onDrawComplete','There was an error while showing message to user via canvas.')}},onImageStreamReady=function(event,args){try{if(lib.drawRLE(lib.getCanvasElementOf(event.sender.ref,args.width,args.height),args.stream,args.width,args.height,args.bgColor)===true){if(activeItems[event.sender.id]){delete activeItems[event.sender.id];activeCount-=1;if(activeCount===0){global.raiseEvent('PrintReadyStateChange',{ready:true,bypass:config.bypass},event.sender)}}}}catch(e){css.invoke('error');global.raiseError(event.sender,'25081810','run','::PrintManager>onImageStreamReady','There was an error while drawing canvas.')}},onBeforeDispose=function(event){lib.removeCanvasElementOf(event.sender.ref)},subscribeToEvents=function(state){var eventAction=state?'addEventListener':'removeEventListener';global.core[eventAction]('ImageStreamReady',onImageStreamReady);global.core[eventAction]('DrawComplete',onDrawComplete);global.core[eventAction]('BeforeDispose',onBeforeDispose)},initialize=function(){if(config.invokeCSS===true){css.invoke('print')}for(var item in global.core.items){queueTrigger(global.core.items[item]);queueTrigger()}},destroy=function(){css.invoke('error');for(var item in global.core.items){if(global.core.items[item].ref===undefined){continue}lib.removeCanvasElementOf(global.core.items[item].ref)}css.invoke('normal')};queueTrigger=function(obj){if(obj instanceof global.core){queuedItems[obj.id]=obj;return}for(var item in queuedItems){onDrawComplete({sender:queuedItems[item]},{});delete queuedItems[item]}};global.extend({printManager:{configure:function(configuration){global.extend(config,configuration||{})},isReady:function(){if(config.bypass){return true}if(activeCount>0||!config.enabled){return false}var item,ref;for(item in global.core.items){if((ref=global.core.items[item].ref)===undefined){continue}if(ref.hasRendered&&ref.hasRendered()===false){return false}}return true},enabled:function(state){if(state===undefined){return config.enabled}if('\v'==='v'||global.renderer.currentRendererName()!=='flash'||typeof document.createElement('canvas').getContext!=='function'){config.bypass=true;global.raiseEvent('PrintReadyStateChange',{ready:true,bypass:config.bypass});global.raiseWarning(global.core,'25081816','run','.printManager.enabled','printManager is not compatible with your browser');return config.enabled}config.bypass=false;subscribeToEvents(state);if(state===true){initialize()}else{destroy()}return(config.enabled=state)},managedPrint:function(){if(config.bypass){window.print();return}if(!global.core.printManager.isReady()){if(global.core.printManager.enabled(true)!==true){window.print();return}global.addEventListener('PrintReadyStateChange',global.core.printManager.managedPrint);return}if(typeof arguments[1]==='object'&&arguments[1].ready!==true){return}global.removeEventListener('PrintReadyStateChange',global.core.printManager.managedPrint);window.print()}}},false);FusionChartsEvents.PrintReadyStateChange='printreadystatechange'}());